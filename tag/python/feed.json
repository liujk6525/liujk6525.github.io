{
    "version": "https://jsonfeed.org/version/1",
    "title": "ä½ ä¸æ˜¯å•æ‰“ç‹¬æ–— â€¢ All posts by \"python\" tag",
    "description": "",
    "home_page_url": "https://liujk6525.github.io",
    "items": [
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/",
            "title": "èšç±»ç®—æ³•",
            "date_published": "2023-06-07T11:53:51.000Z",
            "content_html": "<h1 id=\"èšç±»clusterç®—æ³•\"><a href=\"https://baike.baidu.com/item/%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/1252197?fr=aladdin\">èšç±»ï¼ˆClusterï¼‰ç®—æ³•</a></h1>\r\n<h2 id=\"k-means\"><a href=\"https://baike.baidu.com/item/K%E5%9D%87%E5%80%BC%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/15779627?fromtitle=K-MEANS%E7%AE%97%E6%B3%95&amp;fromid=594631&amp;fr=aladdin\">K-Means</a></h2>\r\n<p>ä»¥ç©ºé—´ä¸­kä¸ªç‚¹ä¸ºä¸­å¿ƒè¿›è¡Œèšç±»ï¼Œå¯¹æœ€é è¿‘ä»–ä»¬çš„å¯¹è±¡å½’ç±»ã€‚é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œé€æ¬¡æ›´æ–°å„èšç±»ä¸­å¿ƒçš„å€¼ï¼Œç›´è‡³å¾—åˆ°æœ€å¥½çš„èšç±»ç»“æœã€‚</p>\r\n<p>åŒä¸€èšç±»ä¸­çš„å¯¹è±¡ç›¸ä¼¼åº¦è¾ƒé«˜ï¼›è€Œä¸åŒèšç±»ä¸­çš„å¯¹è±¡ç›¸ä¼¼åº¦è¾ƒå°ã€‚</p>\r\n<p>ç®—æ³•æµç¨‹ï¼š</p>\r\n<ol type=\"1\">\r\n<li><p>å…ˆä»æ²¡æœ‰æ ‡ç­¾çš„å…ƒç´ é›†åˆAä¸­éšæœºå–kä¸ªå…ƒç´ ï¼Œä½œä¸º kä¸ªå­é›†å„è‡ªçš„é‡å¿ƒã€‚</p></li>\r\n<li><p>åˆ†åˆ«è®¡ç®—å‰©ä¸‹çš„å…ƒç´ åˆ°kä¸ªå­é›†é‡å¿ƒçš„è·ç¦»ï¼ˆè¿™é‡Œçš„è·ç¦»ä¹Ÿå¯ä»¥ä½¿ç”¨æ¬§æ°è·ç¦»ï¼‰ï¼Œæ ¹æ®è·ç¦»å°†è¿™äº›å…ƒç´ åˆ†åˆ«åˆ’å½’åˆ°æœ€è¿‘çš„å­é›†ã€‚</p></li>\r\n<li><p>æ ¹æ®èšç±»ç»“æœï¼Œé‡æ–°è®¡ç®—é‡å¿ƒï¼ˆé‡å¿ƒçš„è®¡ç®—æ–¹æ³•æ˜¯ è®¡ç®—å­é›†ä¸­æ‰€æœ‰å…ƒç´ å„ä¸ªç»´åº¦çš„ç®—æ•°å¹³å‡æ•°ï¼‰ã€‚</p></li>\r\n<li><p>å°†é›†åˆAä¸­å…¨éƒ¨å…ƒç´ æŒ‰ç…§æ–°çš„é‡å¿ƒç„¶åå†é‡æ–°èšç±»ã€‚</p></li>\r\n<li><p>é‡å¤ç¬¬4æ­¥ï¼Œç›´åˆ°èšç±»ç»“æœä¸å†å‘ç”Ÿå˜åŒ–ã€‚</p></li>\r\n</ol>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¿½è§†è­¦å‘Š</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> warnings</span><br><span class=\"line\">warnings.filterwarnings(<span class=\"string\">&quot;ignore&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;kmeans.txt&quot;</span>, delimiter=<span class=\"string\">&quot; &quot;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®kå€¼ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨è®¾ç½®Kå€¼</span></span><br><span class=\"line\">k=<span class=\"number\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹</span></span><br><span class=\"line\">model = KMeans(n_clusters=k,n_init=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">model.fit(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ†ç±»ä¸­å¿ƒç‚¹åæ ‡</span></span><br><span class=\"line\">centers = model.cluster_centers_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(centers)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é¢„æµ‹ç»“æœ</span></span><br><span class=\"line\">result = model.predict(data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(result)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªæ•°æ®ç‚¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºåˆ†ç±»</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;^r&#x27;</span>, <span class=\"string\">&#x27;vb&#x27;</span>, <span class=\"string\">&#x27;pg&#x27;</span>, <span class=\"string\">&#x27;+c&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,d <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(data):</span><br><span class=\"line\">    plt.plot(d[<span class=\"number\">0</span>], d[<span class=\"number\">1</span>], mark[result[i]])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªåˆ†ç±»çš„ä¸­å¿ƒç‚¹</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;*r&#x27;</span>, <span class=\"string\">&#x27;*b&#x27;</span>, <span class=\"string\">&#x27;*g&#x27;</span>, <span class=\"string\">&#x27;*c&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,center <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(centers):</span><br><span class=\"line\">    plt.plot(center[<span class=\"number\">0</span>],center[<span class=\"number\">1</span>], mark[i], markersize=<span class=\"number\">20</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªæ•°æ®ç‚¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºåˆ†ç±»</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;^r&#x27;</span>, <span class=\"string\">&#x27;vb&#x27;</span>, <span class=\"string\">&#x27;pg&#x27;</span>, <span class=\"string\">&#x27;+c&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,d <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(data):</span><br><span class=\"line\">    plt.plot(d[<span class=\"number\">0</span>], d[<span class=\"number\">1</span>], mark[result[i]])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªåˆ†ç±»çš„ä¸­å¿ƒç‚¹</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;*r&#x27;</span>, <span class=\"string\">&#x27;*b&#x27;</span>, <span class=\"string\">&#x27;*g&#x27;</span>, <span class=\"string\">&#x27;*c&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,center <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(centers):</span><br><span class=\"line\">    plt.plot(center[<span class=\"number\">0</span>],center[<span class=\"number\">1</span>], mark[i], markersize=<span class=\"number\">20</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607203700434.png\"  style=\"zoom:50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607203924280.png\"  style=\"zoom:52%;\" /></p>\r\n<h2 id=\"mini-batch-k-means\">Mini Batch K-Means</h2>\r\n<p>é‡‡ç”¨å°æ‰¹é‡çš„æ•°æ®å­é›†å‡å°è®¡ç®—æ—¶é—´ã€‚ä¹Ÿå°±æ˜¯éšæœºæŠ½å–æ•°æ®å­é›†è¿›è¡Œè®­ç»ƒç®—æ³•ï¼Œç»“æœä¸€èˆ¬åªç•¥å·®äºæ ‡å‡†ç®—æ³•ã€‚</p>\r\n<p>1ï¼šä»æ•°æ®é›†ä¸­éšæœºæŠ½å–ä¸€äº›æ•°æ®å½¢æˆå°æ‰¹é‡ï¼ŒæŠŠä»–ä»¬åˆ†é…ç»™æœ€è¿‘çš„è´¨å¿ƒ</p>\r\n<p>2ï¼šæ›´æ–°è´¨å¿ƒï¼Œä¸<strong>K-Means</strong>ç®—æ³•ç›¸æ¯”ï¼Œæ•°æ®çš„æ›´æ–°æ˜¯åœ¨æ¯ä¸€ä¸ªå°çš„æ ·æœ¬é›†ä¸Šã€‚</p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -1\">ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> MiniBatchKMeans</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"comment\"># å¿½è§†è­¦å‘Š</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> warnings</span><br><span class=\"line\">warnings.filterwarnings(<span class=\"string\">&quot;ignore&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;kmeans.txt&quot;</span>, delimiter=<span class=\"string\">&quot; &quot;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®kå€¼</span></span><br><span class=\"line\">k = <span class=\"number\">4</span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹</span></span><br><span class=\"line\">model = MiniBatchKMeans(n_clusters=k,n_init=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">model.fit(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ†ç±»ä¸­å¿ƒç‚¹åæ ‡</span></span><br><span class=\"line\">centers = model.cluster_centers_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(centers)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é¢„æµ‹ç»“æœ</span></span><br><span class=\"line\">result = model.predict(data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(result)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªæ•°æ®ç‚¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºåˆ†ç±»</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;or&#x27;</span>, <span class=\"string\">&#x27;ob&#x27;</span>, <span class=\"string\">&#x27;og&#x27;</span>, <span class=\"string\">&#x27;oy&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,d <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(data):</span><br><span class=\"line\">    plt.plot(d[<span class=\"number\">0</span>], d[<span class=\"number\">1</span>], mark[result[i]])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªåˆ†ç±»çš„ä¸­å¿ƒç‚¹</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;*r&#x27;</span>, <span class=\"string\">&#x27;*b&#x27;</span>, <span class=\"string\">&#x27;*g&#x27;</span>, <span class=\"string\">&#x27;*y&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,center <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(centers):</span><br><span class=\"line\">    plt.plot(center[<span class=\"number\">0</span>],center[<span class=\"number\">1</span>], mark[i], markersize=<span class=\"number\">20</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># æ˜¾ç¤ºç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªæ•°æ®ç‚¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºåˆ†ç±»</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;or&#x27;</span>, <span class=\"string\">&#x27;ob&#x27;</span>, <span class=\"string\">&#x27;og&#x27;</span>, <span class=\"string\">&#x27;oy&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,d <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(data):</span><br><span class=\"line\">    plt.plot(d[<span class=\"number\">0</span>], d[<span class=\"number\">1</span>], mark[result[i]])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªåˆ†ç±»çš„ä¸­å¿ƒç‚¹</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;*r&#x27;</span>, <span class=\"string\">&#x27;*b&#x27;</span>, <span class=\"string\">&#x27;*g&#x27;</span>, <span class=\"string\">&#x27;*y&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,center <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(centers):</span><br><span class=\"line\">    plt.plot(center[<span class=\"number\">0</span>],center[<span class=\"number\">1</span>], mark[i], markersize=<span class=\"number\">20</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607205405646.png\"  style=\"zoom:50%;\" /></p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230607204231807.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"dbscandensity-based-spatial-clustering-of-applications-with-noise\"><a href=\"https://baike.baidu.com/item/DBSCAN/4864716?fr=aladdin\">DBSCANï¼ˆDensity-Based Spatial Clustering of Applications with Noiseï¼‰</a></h1>\r\n<p>èƒ½å¤Ÿå°†å…·æœ‰è¶³å¤Ÿé«˜å¯†åº¦çš„åŒºåŸŸåˆ’åˆ†ä¸ºç°‡ï¼Œå¹¶å¯åœ¨å™ªå£°çš„ç©ºé—´æ•°æ®åº“ä¸­å‘ç°ä»»æ„å½¢çŠ¶çš„<a href=\"https://baike.baidu.com/item/èšç±»/593695?fromModule=lemma_inlink\">èšç±»</a>ã€‚</p>\r\n<p><span class=\"math inline\">\\(\\Epsilon\\)</span>é‚»åŸŸï¼šç»™å®šå¯¹è±¡åŠå¾„<span class=\"math inline\">\\(\\Epsilon\\)</span>å†…çš„åŒºåŸŸç§°ä¸ºè¯¥å¯¹è±¡çš„<span class=\"math inline\">\\(\\Epsilon\\)</span>é‚»åŸŸã€‚</p>\r\n<p>æ ¸å¿ƒå¯¹è±¡ï¼šå¦‚æœç»™å®š<span class=\"math inline\">\\(\\Epsilon\\)</span>é‚»åŸŸå†…çš„æ ·æœ¬ç‚¹æ•°å¤§äºç­‰äº<span class=\"math inline\">\\(Minpoints\\)</span>ï¼Œåˆ™è¯¥å¯¹è±¡ä¸ºæ ¸å¿ƒå¯¹è±¡ã€‚</p>\r\n<p>ç›´æ¥å¯†åº¦å¯è¾¾ï¼šç»™å®šä¸€ä¸ªå¯¹è±¡é›†åˆ<span class=\"math inline\">\\(D\\)</span>ï¼Œå¦‚æœ<span class=\"math inline\">\\(p\\)</span>åœ¨<span class=\"math inline\">\\(q\\)</span>çš„<span class=\"math inline\">\\(\\Epsilon\\)</span>é‚»åŸŸå†…ï¼Œ ä¸”<span class=\"math inline\">\\(q\\)</span>æ˜¯ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡ï¼Œåˆ™æˆ‘ä»¬è¯´å¯¹è±¡<span class=\"math inline\">\\(p\\)</span>ä»<span class=\"math inline\">\\(q\\)</span>è§¦å‘æ˜¯ç›´æ¥å¯†åº¦å¯è¾¾çš„ï¼ˆdirectly density-reachableï¼‰ã€‚</p>\r\n<p>å¯†åº¦å¯è¾¾ï¼šé›†åˆ<span class=\"math inline\">\\(D\\)</span>ï¼Œå­˜åœ¨ä¸€ä¸ªå¯¹è±¡é“¾ <span class=\"math inline\">\\(p_1,p_2,\\cdots ,pn,p_1=q,p_n=p\\)</span>ï¼Œ<span class=\"math inline\">\\(p_{i+1}\\)</span>æ˜¯ä»<span class=\"math inline\">\\(p_i\\)</span>å…³äºğœ€å’Œ<span class=\"math inline\">\\(Minpoints\\)</span>ç›´æ¥å¯†åº¦å¯è¾¾ï¼Œåˆ™ç§°ç‚¹<span class=\"math inline\">\\(p\\)</span>æ˜¯ä»<span class=\"math inline\">\\(q\\)</span>å…³äº<span class=\"math inline\">\\(\\Epsilon\\)</span>å’Œ<span class=\"math inline\">\\(Minpoints\\)</span>å¯†åº¦å¯è¾¾çš„ã€‚</p>\r\n<p>å¯†åº¦ç›¸è¿ï¼šé›†åˆ<span class=\"math inline\">\\(D\\)</span>å­˜åœ¨ç‚¹<span class=\"math inline\">\\(o\\)</span>ï¼Œä½¿å¾—ç‚¹<span class=\"math inline\">\\(pã€q\\)</span>æ˜¯ä»<span class=\"math inline\">\\(o\\)</span>å…³äº<span class=\"math inline\">\\(\\Epsilon\\)</span>å’Œ <span class=\"math inline\">\\(Minpoints\\)</span>å¯†åº¦å¯è¾¾çš„ï¼Œé‚£ä¹ˆç‚¹<span class=\"math inline\">\\(pã€q\\)</span>æ˜¯å…³äº<span class=\"math inline\">\\(\\Epsilon\\)</span>å’Œ <span class=\"math inline\">\\(Minpoints\\)</span>å¯†åº¦ç›¸è¿çš„ã€‚</p>\r\n<p>ç®—æ³•æµç¨‹ï¼š</p>\r\n<ol type=\"1\">\r\n<li><p>æŒ‡å®šåˆé€‚çš„<span class=\"math inline\">\\(\\Epsilon\\)</span>å’Œ <span class=\"math inline\">\\(Minpoints\\)</span>ã€‚</p></li>\r\n<li><p>è®¡ç®—æ‰€æœ‰çš„æ ·æœ¬ç‚¹ï¼Œå¦‚æœç‚¹<span class=\"math inline\">\\(p\\)</span>çš„<span class=\"math inline\">\\(\\Epsilon\\)</span>é‚»åŸŸé‡Œæœ‰è¶…è¿‡<span class=\"math inline\">\\(Minpoints\\)</span>ä¸ªç‚¹ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªä»¥<span class=\"math inline\">\\(p\\)</span>ä¸ºæ ¸å¿ƒç‚¹çš„æ–°ç°‡ã€‚</p></li>\r\n<li><p>åå¤å¯»æ‰¾è¿™äº›æ ¸å¿ƒç‚¹ç›´æ¥å¯†åº¦å¯è¾¾ï¼ˆä¹‹åå¯èƒ½æ˜¯å¯†åº¦å¯è¾¾ï¼‰ çš„ç‚¹ï¼Œå°†å…¶åŠ å…¥åˆ°ç›¸åº”çš„ç°‡ï¼Œå¯¹äºæ ¸å¿ƒç‚¹å‘ç”Ÿâ€œå¯†åº¦ç›¸è¿â€ çŠ¶å†µçš„ç°‡ï¼Œç»™äºˆåˆå¹¶ã€‚</p></li>\r\n<li><p>æ²¡æœ‰æ–°çš„ç‚¹å¯ä»¥è¢«æ·»åŠ åˆ°ä»»ä½•ç°‡æ—¶ï¼Œç®—æ³•ç»“æŸ</p></li>\r\n</ol>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -2\">ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> DBSCAN</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;kmeans.txt&quot;</span>, delimiter=<span class=\"string\">&quot; &quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">result = model.fit_predict(data)</span><br><span class=\"line\">result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å‡ºå„ä¸ªæ•°æ®ç‚¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºåˆ†ç±»</span></span><br><span class=\"line\">mark = [<span class=\"string\">&#x27;or&#x27;</span>, <span class=\"string\">&#x27;ob&#x27;</span>, <span class=\"string\">&#x27;og&#x27;</span>, <span class=\"string\">&#x27;oy&#x27;</span>, <span class=\"string\">&#x27;ok&#x27;</span>, <span class=\"string\">&#x27;om&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i,d <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(data):</span><br><span class=\"line\">    plt.plot(d[<span class=\"number\">0</span>], d[<span class=\"number\">1</span>], mark[result[i]])</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607205310944.png\"  style=\"zoom:50%;\" /></p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">x1, y1 = datasets.make_circles(n_samples=<span class=\"number\">2000</span>, factor=<span class=\"number\">0.5</span>, noise=<span class=\"number\">0.05</span>)</span><br><span class=\"line\">x2, y2 = datasets.make_blobs(n_samples=<span class=\"number\">1000</span>, centers=[[<span class=\"number\">1.2</span>,<span class=\"number\">1.2</span>]], cluster_std=[[<span class=\"number\">.1</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">x = np.concatenate((x1, x2))</span><br><span class=\"line\">plt.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], marker=<span class=\"string\">&#x27;o&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> DBSCAN</span><br><span class=\"line\">y_pred = DBSCAN(eps = <span class=\"number\">0.2</span>, min_samples=<span class=\"number\">50</span>).fit_predict(x)</span><br><span class=\"line\">plt.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], c=y_pred)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607205925872.png\"  style=\"zoom:50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607205903894.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=71&amp;vd_source=fe8e916be2bd597efffd8dfd95249141\">èšç±»ç®—æ³•</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%AE%97%E6%B3%95/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%AE%97%E6%B3%95/",
            "title": "è´å¶æ–¯ç®—æ³•",
            "date_published": "2023-06-07T07:56:38.000Z",
            "content_html": "<h1 id=\"è´å¶æ–¯ç®—æ³•\">è´å¶æ–¯ç®—æ³•</h1>\r\n<ul>\r\n<li>æ€»ä½“ä¿¡æ¯ï¼šå½“å‰æ€»ä½“æ ·æœ¬ç¬¦åˆæŸç§åˆ†å¸ƒã€‚æ¯”å¦‚æŠ›ç¡¬å¸ç¬¦åˆäºŒé¡¹ åˆ†å¸ƒï¼›å­¦ç”Ÿçš„æŸä¸€ç§‘çš„æˆç»©ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚</li>\r\n<li>æ ·æœ¬ä¿¡æ¯ï¼šé€šè¿‡æŠ½æ ·å¾—åˆ°çš„éƒ¨åˆ†æ ·æœ¬çš„æŸç§åˆ†å¸ƒã€‚</li>\r\n<li>æŠ½æ ·ä¿¡æ¯=æ€»ä½“ä¿¡æ¯+æ ·æœ¬ä¿¡æ¯</li>\r\n<li>å…ˆéªŒä¿¡æ¯ï¼šæŠ½æ ·ä¹‹å‰ï¼Œæœ‰å…³æ¨æ–­é—®é¢˜ä¸­æœªçŸ¥å‚æ•°çš„ä¸€äº›ä¿¡æ¯ï¼Œ é€šå¸¸æ¥è‡ªäºç»éªŒæˆ–å†å²èµ„æ–™ã€‚</li>\r\n</ul>\r\n<p>åŸºäºæŠ½æ ·ä¿¡æ¯è¿›è¡Œç»Ÿè®¡æ¨æ–­çš„ç†è®ºå’Œæ–¹æ³•ç§°ä¸ºç»å…¸ç»Ÿè®¡å­¦ã€‚</p>\r\n<p>åŸºäºæŠ½æ ·ä¿¡æ¯+å…ˆéªŒä¿¡æ¯è¿›è¡Œç»Ÿè®¡æ¨æ–­çš„æ–¹æ³•å’Œç† è®ºï¼Œç§°ä¸ºè´å¶æ–¯ç»Ÿè®¡å­¦ã€‚</p>\r\n<h2 id=\"è´å¶æ–¯å®šç†\"><a href=\"https://baike.baidu.com/item/%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%85%AC%E5%BC%8F/9683982?fr=aladdin\">è´å¶æ–¯å®šç†</a></h2>\r\n<p>å·²çŸ¥<span class=\"math inline\">\\(P(X|H)\\)</span>ï¼Œè¦æ±‚è§£<span class=\"math inline\">\\(P(H|X)\\)</span> <span class=\"math display\">\\[\r\nP(H|X)=\\frac{P(X|H)P(H)}{P(X)}\r\n\\]</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¯¼å…¥ç®—æ³•åŒ…ä»¥åŠæ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report,confusion_matrix</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.naive_bayes <span class=\"keyword\">import</span> MultinomialNB,BernoulliNB,GaussianNB</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">iris = datasets.load_iris()</span><br><span class=\"line\">x_train,x_test,y_train,y_test = train_test_split(iris.data, iris.target) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">mul_nb = GaussianNB()</span><br><span class=\"line\">mul_nb.fit(x_train,y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¯„ä¼°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(mul_nb.predict(x_test),y_test))</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607165131324.png\"  style=\"zoom: 67%;\" /></p>\r\n<h2 id=\"è¯è¢‹æ¨¡å‹bag-of-words\">è¯è¢‹æ¨¡å‹(Bag of Words)</h2>\r\n<p>Bag of words modelï¼ˆBoWï¼‰æœ€æ—©å‡ºç°åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processingï¼‰å’Œä¿¡æ¯æ£€ç´¢ ï¼ˆInformation Retrievalï¼‰é¢†åŸŸã€‚</p>\r\n<p>è¯¥æ¨¡å‹å¿½ç•¥æ‰æ–‡æœ¬çš„è¯­æ³•å’Œè¯­åºç­‰è¦ç´ ï¼Œå°†å…¶ä»…ä»…çœ‹ä½œæ˜¯è‹¥å¹²ä¸ªè¯æ±‡çš„é›†åˆï¼Œæ–‡æ¡£ä¸­æ¯ä¸ªå•è¯çš„å‡ºç°éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚BoWä½¿ç”¨ä¸€ç»„æ— åºçš„å•è¯(words)æ¥è¡¨è¾¾ä¸€æ®µæ–‡å­—æˆ–ä¸€ä¸ªæ–‡æ¡£ã€‚</p>\r\n<p>ç®€å•ä¾‹å­</p>\r\n<p>é¦–å…ˆç»™å‡ºä¸¤ä¸ªç®€å•çš„æ–‡æœ¬æ–‡æ¡£å¦‚ä¸‹ï¼š</p>\r\n<p>John likes to watch movies. Mary likes too.</p>\r\n<p>John also likes to watch football games.</p>\r\n<p>å¯¹äºä¸Šè¿°ä¸¤ä¸ªæ–‡æ¡£ä¸­å‡ºç°çš„å•è¯ï¼Œæ„å»ºå¦‚ä¸‹ä¸€ä¸ªè¯å…¸ (dictionary)ï¼š</p>\r\n<p>{â€œJohnâ€: 1, â€œlikesâ€: 2,â€œtoâ€: 3, â€œwatchâ€: 4, â€œmoviesâ€: 5,â€œalsoâ€: 6, â€œfootballâ€: 7, â€œgamesâ€: 8,â€œMaryâ€: 9, â€œtooâ€: 10}</p>\r\n<p>ä¸Šé¢çš„è¯å…¸ä¸­åŒ…å«10ä¸ªå•è¯, æ¯ä¸ªå•è¯æœ‰å”¯ä¸€çš„ç´¢å¼•, é‚£ä¹ˆæ¯ä¸ªæ–‡æœ¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª10ç»´çš„å‘é‡æ¥è¡¨ç¤ºã€‚</p>\r\n<p>[1, 2, 1, 1, 1, 0, 0, 0, 1, 1]</p>\r\n<p>[1, 1,1, 1, 0, 1, 1, 1, 0, 0]</p>\r\n<p>è¯¥å‘é‡ä¸åŸæ¥æ–‡æœ¬ä¸­å•è¯å‡ºç°çš„é¡ºåºæ²¡æœ‰å…³ç³»ï¼Œè€Œæ˜¯è¯å…¸ä¸­æ¯ä¸ªå•è¯åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„é¢‘ç‡ã€‚</p>\r\n<h2 id=\"tf-idf\">TF-IDF</h2>\r\n<p>TFï¼ˆTerm Frequencyï¼‰ è¯é¢‘</p>\r\n<p>IDF ï¼ˆInverse Document Frequencyï¼‰é€†æ–‡æ¡£é¢‘ç‡</p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=60\">è´å¶æ–¯ç®—æ³•</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/",
            "title": "é›†æˆå­¦ä¹ ",
            "date_published": "2023-06-07T01:32:09.000Z",
            "content_html": "<h1 id=\"é›†æˆå­¦ä¹ ensemble-learning\"><a href=\"https://baike.baidu.com/item/%E5%88%86%E7%B1%BB%E5%99%A8%E9%9B%86%E6%88%90/21512231?fromtitle=%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0&amp;fromid=3440721&amp;fr=aladdin\">é›†æˆå­¦ä¹ ï¼ˆEnsemble Learningï¼‰</a></h1>\r\n<p>é›†æˆå­¦ä¹ å°±æ˜¯ç»„åˆå¤šä¸ªå­¦ä¹ å™¨ï¼Œæœ€åå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´ å¥½çš„å­¦ä¹ å™¨ã€‚</p>\r\n<p>é›†æˆå­¦ä¹ ç®—æ³•ï¼š</p>\r\n<ol type=\"1\">\r\n<li><p>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œè£…è¢‹ï¼ˆBaggingï¼‰</p></li>\r\n<li><p>éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰</p></li>\r\n<li><p>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œæå‡ï¼ˆBoostingï¼‰</p></li>\r\n<li><p>Stacking</p></li>\r\n</ol>\r\n<span id=\"more\"></span>\r\n<h2 id=\"bagging\">Bagging</h2>\r\n<p>Baggingä¹Ÿå«åšBootstrap Aggregatingï¼Œæ˜¯åœ¨åŸå§‹ æ•°æ®é›†é€‰æ‹©Sæ¬¡åå¾—åˆ°Sä¸ªæ–°æ•°æ®é›†çš„ä¸€ç§æŠ€æœ¯ã€‚æ˜¯ä¸€ ç§æœ‰æ”¾å›æŠ½æ ·ã€‚</p>\r\n<p>åŸå§‹è®­ç»ƒæ•°æ®é›†<span class=\"math inline\">\\(0,1,2,3,4,5,6,7,8,9\\)</span></p>\r\n<p>Baggingé‡‡æ ·<span class=\"math inline\">\\(1,3,5,2,6,4,2,5,7,0â€”â€”æœªé‡‡æ ·8,9\\)</span></p>\r\n<h3 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç </h3>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¯¼å…¥ç®—æ³•åŒ…ä»¥åŠæ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> neighbors</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> BaggingClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">åˆ’åˆ†æ•°æ®é›†</span><br><span class=\"line\">iris = datasets.load_iris()</span><br><span class=\"line\">x_data = iris.data[:,:<span class=\"number\">2</span>]</span><br><span class=\"line\">y_data = iris.target</span><br><span class=\"line\"></span><br><span class=\"line\">x_train,x_test,y_train,y_test = train_test_split(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶è®­ç»ƒKNNæ¨¡å‹</span></span><br><span class=\"line\">knn = neighbors.KNeighborsClassifier()</span><br><span class=\"line\">knn.fit(x_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot</span>(<span class=\"params\">model</span>):</span><br><span class=\"line\">    <span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">    x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">    y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">    xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                         np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">    z = z.reshape(xx.shape)</span><br><span class=\"line\">    <span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">    cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">plot(knn)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&quot;knn&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">knn.score(x_test, y_test) <span class=\"comment\"># KNNæ¨¡å‹å‡†ç¡®ç‡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶è®­ç»ƒbagging_knnæ¨¡å‹</span></span><br><span class=\"line\">bagging_knn = BaggingClassifier(knn, n_estimators=<span class=\"number\">100</span>)</span><br><span class=\"line\">bagging_knn.fit(x_train, y_train)</span><br><span class=\"line\">plot(bagging_knn)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;bagging_knn&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">bagging_knn.score(x_test, y_test) <span class=\"comment\"># bagging_knnæ¨¡å‹å‡†ç¡®ç‡</span></span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607113057905.png\"  style=\"zoom:50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607113349947.png\"  style=\"zoom:50%;\" /></p>\r\n<h2 id=\"éšæœºæ£®æ—random-forest\"><a href=\"https://baike.baidu.com/item/%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97/1974765?fr=aladdin\">éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰</a></h2>\r\n<p>ç®—æ³•æµç¨‹ï¼š</p>\r\n<ol type=\"1\">\r\n<li><p>éšæœºé€‰å–æ ·æœ¬ï¼šåœ¨æ ·æœ¬é›†ç”¨<strong>bagging</strong>çš„æ–¹å¼éšæœºé€‰æ‹©nä¸ªæ ·æœ¬ã€‚</p></li>\r\n<li><p>éšæœºé€‰å–ç‰¹å¾ï¼šä»æ‰€æœ‰å±æ€§dä¸­éšæœºé€‰æ‹©kä¸ªå±æ€§ï¼ˆk&lt;dï¼‰ï¼Œç„¶åä»kä¸ªå±æ€§ä¸­é€‰æ‹©æœ€ä½³åˆ†å‰²å±æ€§ä½œä¸ºèŠ‚ç‚¹å»ºç«‹ CARTå†³ç­–æ ‘ã€‚</p></li>\r\n<li><p>é‡å¤ä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤mæ¬¡ï¼Œå»ºç«‹mæ£µCARTå†³ç­–æ ‘ã€‚</p></li>\r\n<li><p>è¿™mæ£µCARTå†³ç­–æ ‘å½¢æˆéšæœºæ£®æ—ï¼Œé€šè¿‡æŠ•ç¥¨è¡¨å†³ç»“ æœï¼Œå†³å®šæ•°æ®å±äºå“ªä¸€ç±»ã€‚</p></li>\r\n</ol>\r\n<h3 id=\"ç¤ºä¾‹ä»£ç -1\">ç¤ºä¾‹ä»£ç </h3>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestClassifier <span class=\"comment\"># é›†æˆå­¦ä¹ ä¸­çš„éšæœºæ£®æ—æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;LR-testSet2.txt&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,:-<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[:,-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_data[:,<span class=\"number\">0</span>],x_data[:,<span class=\"number\">1</span>],c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class=\"line\">x_train,x_test,y_train,y_test = train_test_split(x_data, y_data, test_size = <span class=\"number\">0.5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot</span>(<span class=\"params\">model</span>):</span><br><span class=\"line\">    <span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">    x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">    y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">    xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                         np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">    z = z.reshape(xx.shape)</span><br><span class=\"line\">    <span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">    cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\">    <span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">    plt.scatter(x_test[:, <span class=\"number\">0</span>], x_test[:, <span class=\"number\">1</span>], c=y_test)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶è®­ç»ƒéšæœºæ£®æ—æ¨¡å‹</span></span><br><span class=\"line\">RF = RandomForestClassifier(n_estimators=<span class=\"number\">50</span>)</span><br><span class=\"line\">RF.fit(x_train, y_train)</span><br><span class=\"line\">plot(RF)</span><br><span class=\"line\">RF.score(x_test, y_test)</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607114037530.png\"  style=\"zoom:50%;\" /></p>\r\n<h2 id=\"boosting\"><a href=\"https://baike.baidu.com/item/Boosting/1403912?fr=aladdin\">Boosting</a></h2>\r\n<p>AdaBoost ï¼ˆAdaptive Boostingï¼‰ç®—æ³•ï¼Œå®ƒçš„è‡ªé€‚åº”åœ¨äºï¼Œå‰ä¸€ä¸ªåŸºæœ¬åˆ†ç±»å™¨è¢«é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ä¼šå¢å¤§ï¼Œè€Œæ­£ç¡®åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ä¼šå‡å°ï¼Œå¹¶å†æ¬¡ç”¨æ¥è®­ç»ƒä¸‹ä¸€ä¸ªåŸºæœ¬åˆ†ç±»å™¨ã€‚åŒæ—¶ï¼Œåœ¨æ¯ä¸€è½®è¿­ä»£ä¸­ï¼ŒåŠ å…¥ä¸€ä¸ªæ–°çš„å¼±åˆ†ç±»å™¨ï¼Œç›´åˆ°è¾¾åˆ°æŸä¸ªé¢„å®šçš„è¶³å¤Ÿå°çš„é”™è¯¯ç‡æˆ–è¾¾åˆ°é¢„å…ˆæŒ‡å®šçš„æœ€å¤§è¿­ä»£æ¬¡æ•°æ‰ç¡®å®šæœ€ç»ˆçš„å¼ºåˆ†ç±»å™¨ã€‚</p>\r\n<p>ç®—æ³•æµç¨‹ï¼š</p>\r\n<ol type=\"1\">\r\n<li><p>åˆå§‹åŒ–è®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒ<span class=\"math inline\">\\(D1\\)</span>ã€‚å‡è®¾æœ‰<span class=\"math inline\">\\(N\\)</span>ä¸ªè®­ç»ƒæ ·æœ¬æ•°æ®ï¼Œåˆ™æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æœ€å¼€å§‹æ—¶ï¼Œéƒ½è¢«èµ‹äºˆ ç›¸åŒçš„æƒå€¼<span class=\"math inline\">\\(w~1~=1/N\\)</span>ã€‚</p></li>\r\n<li><p>è®­ç»ƒå¼±åˆ†ç±»å™¨<span class=\"math inline\">\\(h_i\\)</span>ã€‚</p>\r\n<ul>\r\n<li><p>å¦‚æœæŸä¸ªè®­ç»ƒæ ·æœ¬ç‚¹ï¼Œè¢«å¼±åˆ†ç±»å™¨<span class=\"math inline\">\\(h_i\\)</span>å‡†ç¡®åœ°åˆ†ç±»ï¼Œé‚£ä¹ˆåœ¨æ„é€ ä¸‹ä¸€ä¸ªè®­ç»ƒé›†ä¸­ï¼Œå®ƒå¯¹åº”çš„æƒå€¼è¦å‡å°ï¼›</p></li>\r\n<li><p>å¦‚æœæŸä¸ªè®­ç»ƒæ ·æœ¬ç‚¹ï¼Œè¢«å¼±åˆ†ç±»å™¨<span class=\"math inline\">\\(h_i\\)</span>é”™è¯¯åˆ†ç±»ï¼Œé‚£ä¹ˆå®ƒçš„æƒå€¼å°±åº”è¯¥å¢å¤§ã€‚æƒå€¼æ›´æ–°è¿‡çš„æ ·æœ¬é›†è¢«ç”¨äºè®­ç»ƒä¸‹ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œæ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¦‚æ­¤è¿­ä»£åœ°è¿›è¡Œä¸‹å»ã€‚</p></li>\r\n</ul></li>\r\n<li><p>å°†å„ä¸ªè®­ç»ƒå¾—åˆ°çš„å¼±åˆ†ç±»å™¨ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ã€‚å„ä¸ªå¼±åˆ†ç±»å™¨çš„è®­ç»ƒè¿‡ç¨‹ç»“æŸåï¼Œ</p>\r\n<ul>\r\n<li>åŠ å¤§åˆ†ç±»è¯¯å·®ç‡å°çš„å¼±åˆ†ç±»å™¨çš„æƒé‡ï¼Œä½¿å…¶åœ¨æœ€ç»ˆçš„åˆ†ç±»å‡½æ•°ä¸­èµ·ç€è¾ƒå¤§çš„å†³å®šä½œç”¨ï¼Œ</li>\r\n<li>é™ä½åˆ†ç±»è¯¯å·®ç‡å¤§çš„å¼±åˆ†ç±»å™¨çš„æƒé‡ï¼Œä½¿å…¶åœ¨æœ€ç»ˆçš„åˆ†ç±»å‡½æ•°ä¸­èµ·ç€è¾ƒå°çš„å†³å®šä½œç”¨ã€‚</li>\r\n</ul></li>\r\n</ol>\r\n<h3 id=\"ç¤ºä¾‹ä»£ç -2\">ç¤ºä¾‹ä»£ç </h3>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> AdaBoostClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.datasets <span class=\"keyword\">import</span> make_gaussian_quantiles</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆ2ç»´æ­£æ€åˆ†å¸ƒï¼Œç”Ÿæˆçš„æ•°æ®æŒ‰åˆ†ä½æ•°åˆ†ä¸ºä¸¤ç±»ï¼Œ500ä¸ªæ ·æœ¬,2ä¸ªæ ·æœ¬ç‰¹å¾</span></span><br><span class=\"line\">x1, y1 = make_gaussian_quantiles(n_samples=<span class=\"number\">500</span>, n_features=<span class=\"number\">2</span>,n_classes=<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆ2ç»´æ­£æ€åˆ†å¸ƒï¼Œç”Ÿæˆçš„æ•°æ®æŒ‰åˆ†ä½æ•°åˆ†ä¸ºä¸¤ç±»ï¼Œ400ä¸ªæ ·æœ¬,2ä¸ªæ ·æœ¬ç‰¹å¾å‡å€¼éƒ½ä¸º3</span></span><br><span class=\"line\">x2, y2 = make_gaussian_quantiles(mean=(<span class=\"number\">3</span>, <span class=\"number\">3</span>), n_samples=<span class=\"number\">500</span>, n_features=<span class=\"number\">2</span>, n_classes=<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\"># å°†ä¸¤ç»„æ•°æ®åˆæˆä¸€ç»„æ•°æ®</span></span><br><span class=\"line\">x_data = np.concatenate((x1, x2))</span><br><span class=\"line\">y_data = np.concatenate((y1, - y2 + <span class=\"number\">1</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># AdaBoostæ¨¡å‹</span></span><br><span class=\"line\">model = AdaBoostClassifier(DecisionTreeClassifier(max_depth=<span class=\"number\">3</span>),n_estimators=<span class=\"number\">10</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®­ç»ƒæ¨¡å‹</span></span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–é¢„æµ‹å€¼</span></span><br><span class=\"line\">z = model.predict(np.c_[xx.ravel(), yy.ravel()])</span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ¨¡å‹å‡†ç¡®ç‡</span></span><br><span class=\"line\">model.score(x_data,y_data)</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607153300730.png\"  style=\"zoom:50%;\" /></p>\r\n<h2 id=\"stacking\">Stacking</h2>\r\n<p>ä½¿ç”¨å¤šä¸ªä¸åŒçš„åˆ†ç±»å™¨å¯¹è®­ç»ƒé›†è¿›é¢„æµ‹ï¼ŒæŠŠé¢„æµ‹ å¾—åˆ°çš„ç»“æœä½œä¸ºä¸€ä¸ªæ¬¡çº§åˆ†ç±»å™¨çš„è¾“å…¥ã€‚æ¬¡çº§åˆ† ç±»å™¨çš„è¾“å‡ºæ˜¯æ•´ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607153502918.png\"  style=\"zoom:67%;\" /></p>\r\n<h3 id=\"ç¤ºä¾‹ä»£ç -3\">ç¤ºä¾‹ä»£ç </h3>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets  </span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> model_selection  </span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier  </span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> mlxtend.classifier <span class=\"keyword\">import</span> StackingClassifier</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®é›†</span></span><br><span class=\"line\">iris = datasets.load_iris()  </span><br><span class=\"line\"><span class=\"comment\"># åªè¦ç¬¬1,2åˆ—çš„ç‰¹å¾</span></span><br><span class=\"line\">x_data, y_data = iris.data[:, <span class=\"number\">1</span>:<span class=\"number\">3</span>], iris.target  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸‰ä¸ªä¸åŒçš„åˆ†ç±»å™¨</span></span><br><span class=\"line\">clf1 = KNeighborsClassifier(n_neighbors=<span class=\"number\">1</span>)  </span><br><span class=\"line\">clf2 = DecisionTreeClassifier() </span><br><span class=\"line\">clf3 = LogisticRegression()  </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªæ¬¡çº§åˆ†ç±»å™¨</span></span><br><span class=\"line\">lr = LogisticRegression()  </span><br><span class=\"line\">sclf = StackingClassifier(classifiers=[clf1, clf2, clf3],   </span><br><span class=\"line\">                          meta_classifier=lr)</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> clf,label <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>([clf1, clf2, clf3, sclf],</span><br><span class=\"line\">                      [<span class=\"string\">&#x27;KNN&#x27;</span>,<span class=\"string\">&#x27;Decision Tree&#x27;</span>,<span class=\"string\">&#x27;LogisticRegression&#x27;</span>,<span class=\"string\">&#x27;StackingClassifier&#x27;</span>]):  </span><br><span class=\"line\">    scores = model_selection.cross_val_score(clf, x_data, y_data, cv=<span class=\"number\">3</span>, scoring=<span class=\"string\">&#x27;accuracy&#x27;</span>)  </span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Accuracy: %0.2f [%s]&quot;</span> % (scores.mean(), label)) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¯è§†åŒ–   </span></span><br><span class=\"line\">sclf.fit(x_train,y_train)</span><br><span class=\"line\">plot(sclf)</span><br><span class=\"line\">plt.scatter(x_data[:,<span class=\"number\">0</span>],x_data[:,<span class=\"number\">1</span>],c=y_data)    </span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607155449811.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ/?p=55&amp;spm_id_from=333.1007.top_right_bar_window_history.content.click&amp;vd_source=fe8e916be2bd597efffd8dfd95249141\">é›†æˆå­¦ä¹ </a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%86%B3%E7%AD%96%E6%A0%91/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%86%B3%E7%AD%96%E6%A0%91/",
            "title": "å†³ç­–æ ‘",
            "date_published": "2023-06-06T12:25:49.000Z",
            "content_html": "<h1 id=\"å†³ç­–æ ‘-decision-tree\"><a href=\"https://baike.baidu.com/item/%E5%86%B3%E7%AD%96%E6%A0%91/10377049?fr=aladdin\">å†³ç­–æ ‘ ï¼ˆDecision Treeï¼‰</a></h1>\r\n<p>æ¯”è¾ƒé€‚åˆåˆ†æç¦»æ•£æ•°æ®ã€‚ å¦‚æœæ˜¯è¿ç»­æ•°æ®è¦å…ˆè½¬æˆç¦»æ•£æ•°æ®å†åšåˆ†æ</p>\r\n<h2 id=\"ç†µentropy\">ç†µï¼ˆentropyï¼‰</h2>\r\n<p>1948å¹´ï¼Œé¦™æµ“æå‡ºäº†â€œ<a href=\"https://baike.baidu.com/item/%E4%BF%A1%E6%81%AF%E7%86%B5/7302318?fr=aladdin\">ä¿¡æ¯ç†µ</a>â€çš„æ¦‚å¿µï¼Œ</p>\r\n<p><strong>ä¸€æ¡ä¿¡æ¯çš„ä¿¡æ¯é‡å¤§å°å’Œå®ƒçš„ä¸ç¡®å®šæ€§æœ‰ç›´æ¥çš„å…³ç³»ï¼Œ è¦ææ¸…æ¥šä¸€ä»¶éå¸¸éå¸¸ä¸ç¡®å®šçš„äº‹æƒ…ï¼Œæˆ–è€…æ˜¯ä¸€æ— æ‰€çŸ¥çš„äº‹æƒ…ï¼Œéœ€è¦äº†è§£å¤§é‡ä¿¡æ¯ã€‚â€”&gt;ä¿¡æ¯é‡çš„åº¦é‡å°±ç­‰äºä¸ç¡®å®šæ€§çš„å¤šå°‘ã€‚</strong></p>\r\n<span id=\"more\"></span>\r\n<p>ä¿¡æ¯ç†µå…¬å¼ï¼š <span class=\"math display\">\\[\r\nH[x]=-\\sum_{x}p(x)logp(x)\r\n\\]</span></p>\r\n<h2 id=\"id3ç®—æ³•\"><a href=\"https://baike.baidu.com/item/ID3%E7%AE%97%E6%B3%95/5522381?fr=aladdin\">ID3ç®—æ³•</a></h2>\r\n<p>å†³ç­–æ ‘ä¼šé€‰æ‹©æœ€å¤§åŒ–ä¿¡æ¯å¢ç›Šæ¥å¯¹ç»“ç‚¹è¿›è¡Œåˆ’åˆ†ã€‚</p>\r\n<p>ä¿¡æ¯å¢ç›Šï¼ˆInformation Gainï¼‰è®¡ç®—ï¼š <span class=\"math display\">\\[\r\nInfo(D)=-\\sum_{i=1}^{m}p_ilog(p_i)\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nInfo_A(D)=-\\sum_{j=1}^{v}\\frac{|D_j|}{|D|}\\times Info(D_j)\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nGain(A)=Info(D)-Info_A(D)\r\n\\]</span></p>\r\n<table>\r\n<thead>\r\n<tr class=\"header\">\r\n<th>RID</th>\r\n<th>age</th>\r\n<th>income</th>\r\n<th>student</th>\r\n<th>credit_rating</th>\r\n<th>class_buys_computer</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td>1</td>\r\n<td>youth</td>\r\n<td>high</td>\r\n<td>no</td>\r\n<td>fair</td>\r\n<td>no</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>2</td>\r\n<td>youth</td>\r\n<td>high</td>\r\n<td>no</td>\r\n<td>excellent</td>\r\n<td>no</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>3</td>\r\n<td>middle_aged</td>\r\n<td>high</td>\r\n<td>no</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>4</td>\r\n<td>senior</td>\r\n<td>medium</td>\r\n<td>no</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>5</td>\r\n<td>senior</td>\r\n<td>low</td>\r\n<td>yes</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>6</td>\r\n<td>senior</td>\r\n<td>low</td>\r\n<td>yes</td>\r\n<td>excellent</td>\r\n<td>no</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>7</td>\r\n<td>middle_aged</td>\r\n<td>low</td>\r\n<td>yes</td>\r\n<td>excellent</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>8</td>\r\n<td>youth</td>\r\n<td>medium</td>\r\n<td>no</td>\r\n<td>fair</td>\r\n<td>no</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>9</td>\r\n<td>youth</td>\r\n<td>low</td>\r\n<td>yes</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>10</td>\r\n<td>senior</td>\r\n<td>medium</td>\r\n<td>yes</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>11</td>\r\n<td>youth</td>\r\n<td>medium</td>\r\n<td>yes</td>\r\n<td>excellent</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>12</td>\r\n<td>middle_aged</td>\r\n<td>medium</td>\r\n<td>no</td>\r\n<td>excellent</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>13</td>\r\n<td>middle_aged</td>\r\n<td>high</td>\r\n<td>yes</td>\r\n<td>fair</td>\r\n<td>yes</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>14</td>\r\n<td>senior</td>\r\n<td>medium</td>\r\n<td>no</td>\r\n<td>excellent</td>\r\n<td>no</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>è®¡ç®—<strong>age</strong>çš„ä¿¡æ¯å¢ç›Š: <span class=\"math display\">\\[\r\nInfo(D)=-\\frac{9}{14}log_2(\\frac{9}{14})-\\frac{5}{14}log_2(\\frac{5}{14})=0.94\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nInfo_{age}(D)=\\frac{5}{14}(-\\frac{2}{5}log_2\\frac{2}{5}-\\frac{3}{5}log_2\\frac{3}{5})+\r\n\\frac{4}{14}(-\\frac{4}{4}log_2\\frac{4}{4}-\\frac{0}{4}log_2\\frac{0}{4})+\r\n\\frac{5}{14}(-\\frac{3}{5}log_2\\frac{3}{5}-\\frac{2}{5}log_2\\frac{2}{5})\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nGain(age)=Info(D)-Info_A(D)=0.94-0.694=0.246\r\n\\]</span></p>\r\n<p>å…¶ä»–çš„ä¹Ÿæ˜¯ç±»ä¼¼è®¡ç®—ã€‚</p>\r\n<h2 id=\"c4.5ç®—æ³•\"><a href=\"https://baike.baidu.com/item/C4.5%E7%AE%97%E6%B3%95/20814636\">C4.5ç®—æ³•</a></h2>\r\n<p>ä¿¡æ¯å¢ç›Šçš„æ–¹æ³•å€¾å‘äºé¦–å…ˆé€‰æ‹©å› å­æ•°è¾ƒå¤šçš„å˜é‡ ã€‚</p>\r\n<p>ä¿¡æ¯å¢ç›Šçš„æ”¹è¿›ï¼šå¢ç›Šç‡ <span class=\"math display\">\\[\r\nSplitInfo_A(D)=-\\sum_{j=1}^{v}\\frac{|D_j|}{|D|}\\times log_2(\\frac{|D_j|}{|D|})\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nGainRatio(A)=\\frac{Gain(A)}{SpliInfo_A(D)}\r\n\\]</span></p>\r\n<h2 id=\"cartç®—æ³•\"><a href=\"https://baike.baidu.com/item/CART/17679070\">CARTç®—æ³•</a></h2>\r\n<p>CARTå†³ç­–æ ‘çš„ç”Ÿæˆå°±æ˜¯é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ã€‚</p>\r\n<p>CARTç”¨åŸºå°¼ï¼ˆGiniï¼‰ç³»æ•°æœ€å°åŒ–å‡†åˆ™æ¥è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œç”ŸæˆäºŒå‰æ ‘ã€‚</p>\r\n<p>Giniç³»æ•°è®¡ç®—ï¼š <span class=\"math display\">\\[\r\nGini(D)=1-\\sum_{i=1}^{m}p_i^2\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nGini_A(D)=\\frac{|D_1|}{|D|}Gini(D_1)+\\frac{|D_2|}{|D|}Gini(D_2)\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n\\Delta Gini(A)=Gini(D)-Gini_A(D)\r\n\\]</span></p>\r\n<p>ä¼˜ç‚¹ï¼šå°è§„æ¨¡æ•°æ®é›†æœ‰æ•ˆ</p>\r\n<p>ç¼ºç‚¹ï¼š å¤„ç†è¿ç»­å˜é‡ä¸å¥½ ç±»åˆ«è¾ƒå¤šæ—¶ï¼Œé”™è¯¯å¢åŠ çš„æ¯”è¾ƒå¿« ä¸èƒ½å¤„ç†å¤§é‡æ•°æ®</p>\r\n<h2 id=\"çº¿æ€§äºŒåˆ†ç±»ç¤ºä¾‹ä»£ç \">çº¿æ€§äºŒåˆ†ç±»ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree <span class=\"comment\"># å†³ç­–æ ‘æ¨¡å—</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;LR-testSet.csv&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,:-<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[:,-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_data[:,<span class=\"number\">0</span>],x_data[:,<span class=\"number\">1</span>],c=y_data) </span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå†³ç­–æ ‘æ¨¡å‹</span></span><br><span class=\"line\">model = tree.DecisionTreeClassifier()</span><br><span class=\"line\"><span class=\"comment\"># è¾“å…¥æ•°æ®å»ºç«‹æ¨¡å‹</span></span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•ä¸è¯„ä¼°</span></span><br><span class=\"line\">predictions = model.predict(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(predictions,y_data))</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607084609741.png\"  style=\"zoom:50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606214438933.png\"  style=\"zoom:67%;\" /></p>\r\n<h2 id=\"éçº¿æ€§äºŒåˆ†ç±»ç¤ºä¾‹ä»£ç \">éçº¿æ€§äºŒåˆ†ç±»ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;LR-testSet2.txt&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,:-<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[:,-<span class=\"number\">1</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">plt.scatter(x_data[:,<span class=\"number\">0</span>],x_data[:,<span class=\"number\">1</span>],c=y_data) <span class=\"comment\"># sæ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åˆ†å‰²æ•°æ®</span></span><br><span class=\"line\">x_train,x_test,y_train,y_test = train_test_split(x_data, y_data) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå†³ç­–æ ‘æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"comment\"># max_depthï¼Œæ ‘çš„æ·±åº¦</span></span><br><span class=\"line\"><span class=\"comment\"># min_samples_split å†…éƒ¨èŠ‚ç‚¹å†åˆ’åˆ†æ‰€éœ€æœ€å°æ ·æœ¬æ•°</span></span><br><span class=\"line\">model = tree.DecisionTreeClassifier(max_depth=<span class=\"number\">7</span>,min_samples_split=<span class=\"number\">4</span>)</span><br><span class=\"line\"><span class=\"comment\"># æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">model.fit(x_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">z = model.predict(np.c_[xx.ravel(), yy.ravel()])<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•å¹¶è¯„ä¼°</span></span><br><span class=\"line\">predictions = model.predict(x_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(predictions,y_test))</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607084429752.png\"  style=\"zoom: 50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607084526669.png\"  style=\"zoom:67%;\" /></p>\r\n<h2 id=\"å›å½’æ ‘ç¤ºä¾‹ä»£ç \">å›å½’æ ‘ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;data.csv&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,<span class=\"number\">0</span>,np.newaxis]</span><br><span class=\"line\">y_data = data[:,<span class=\"number\">1</span>,np.newaxis]</span><br><span class=\"line\">plt.scatter(x_data,y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\">model = tree.DecisionTreeRegressor(max_depth=<span class=\"number\">5</span>)</span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\">x_test = np.linspace(<span class=\"number\">20</span>,<span class=\"number\">80</span>,<span class=\"number\">100</span>)</span><br><span class=\"line\">x_test = x_test[:,np.newaxis]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">plt.plot(x_data, y_data, <span class=\"string\">&#x27;b&#x27;</span>)</span><br><span class=\"line\">plt.plot(x_test, model.predict(x_test), <span class=\"string\">&#x27;r&#x27;</span>) </span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230607090010220.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=50&amp;vd_source=fe8e916be2bd597efffd8dfd95249141\">å†³ç­–æ ‘</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN%E7%AE%97%E6%B3%95/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN%E7%AE%97%E6%B3%95/",
            "title": "KNNç®—æ³•",
            "date_published": "2023-06-06T12:05:23.000Z",
            "content_html": "<h1 id=\"kæœ€è¿‘é‚»k-nearest-neighborknnåˆ†ç±»ç®—æ³•\"><a href=\"https://baike.baidu.com/item/k%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95/9512781?fr=aladdin\">Kæœ€è¿‘é‚»ï¼ˆK-Nearest Neighborï¼ŒKNNï¼‰</a>åˆ†ç±»ç®—æ³•</h1>\r\n<ol type=\"1\">\r\n<li>ä¸ºäº†åˆ¤æ–­æœªçŸ¥å®ä¾‹çš„ç±»åˆ«ï¼Œä»¥æ‰€æœ‰å·²çŸ¥ç±»åˆ«çš„å®ä¾‹ä½œä¸º å‚ç…§é€‰æ‹©å‚æ•°K</li>\r\n<li>è®¡ç®—æœªçŸ¥å®ä¾‹ä¸æ‰€æœ‰å·²çŸ¥å®ä¾‹çš„è·ç¦»</li>\r\n<li>é€‰æ‹©æœ€è¿‘Kä¸ªå·²çŸ¥å®ä¾‹</li>\r\n<li>æ ¹æ®å°‘æ•°æœä»å¤šæ•°çš„æŠ•ç¥¨æ³•åˆ™(majority-voting)ï¼Œè®© æœªçŸ¥å®ä¾‹å½’ç±»ä¸ºKä¸ªæœ€é‚»è¿‘æ ·æœ¬ä¸­æœ€å¤šæ•°çš„ç±»åˆ«</li>\r\n</ol>\r\n<span id=\"more\"></span>\r\n<p>æ¬§æ°è·ç¦» <span class=\"math display\">\\[\r\nE(x,y)=\\sqrt{\\sum_{i=0}^{n}(x_i-y_i)^2}\r\n\\]</span> <a href=\"https://www.cnblogs.com/belfuture/p/5871452.html\">å…¶ä»–çš„è·ç¦»è¡¡é‡</a>ï¼šä½™å¼¦å€¼è·ç¦»ï¼ˆcosï¼‰ï¼Œç›¸å…³åº¦ï¼ˆcorrelationï¼‰ï¼Œæ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan distanceï¼‰</p>\r\n<p>ç®—æ³•ç¼ºç‚¹ï¼š</p>\r\n<ul>\r\n<li>ç®—æ³•å¤æ‚åº¦è¾ƒé«˜ï¼ˆéœ€è¦æ¯”è¾ƒæ‰€æœ‰å·²çŸ¥å®ä¾‹ä¸è¦åˆ†ç±»çš„å®ä¾‹ï¼‰</li>\r\n<li>å½“å…¶æ ·æœ¬åˆ†å¸ƒä¸å¹³è¡¡æ—¶ï¼Œæ¯”å¦‚å…¶ä¸­ä¸€ç±»æ ·æœ¬è¿‡å¤§ï¼ˆå®ä¾‹æ•°é‡è¿‡å¤šï¼‰å ä¸»å¯¼çš„æ—¶å€™ï¼Œæ–°çš„æœªçŸ¥å®ä¾‹å®¹æ˜“è¢«å½’ç±»ä¸ºè¿™ä¸ªä¸»å¯¼æ ·æœ¬ï¼Œå› ä¸ºè¿™ç±»æ ·æœ¬å®ä¾‹çš„æ•°é‡è¿‡å¤§ï¼Œä½†è¿™ä¸ªæ–°çš„æœªçŸ¥å®ä¾‹å®é™…å¹¶æ²¡æœ‰æ¥è¿‘ç›®æ ‡æ ·æœ¬</li>\r\n</ul>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¯¼å…¥ç®—æ³•åŒ…ä»¥åŠæ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> neighbors</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">iris = datasets.load_iris()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(iris)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰“ä¹±æ•°æ®åˆ‡åˆ†æ•°æ®é›†</span></span><br><span class=\"line\"><span class=\"comment\"># x_train,x_test,y_train,y_test = train_test_split(iris.data, iris.target, test_size=0.2) #åˆ†å‰²æ•°æ®0.2ä¸ºæµ‹è¯•æ•°æ®ï¼Œ0.8ä¸ºè®­ç»ƒæ•°æ®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#æ‰“ä¹±æ•°æ®</span></span><br><span class=\"line\">data_size = iris.data.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">index = [i <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(data_size)] </span><br><span class=\"line\">random.shuffle(index)  </span><br><span class=\"line\">iris.data = iris.data[index]</span><br><span class=\"line\">iris.target = iris.target[index]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#åˆ‡åˆ†æ•°æ®é›†</span></span><br><span class=\"line\">test_size = <span class=\"number\">40</span></span><br><span class=\"line\">x_train = iris.data[test_size:]</span><br><span class=\"line\">x_test =  iris.data[:test_size]</span><br><span class=\"line\">y_train = iris.target[test_size:]</span><br><span class=\"line\">y_test = iris.target[:test_size]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ„å»ºæ¨¡å‹</span></span><br><span class=\"line\">model = neighbors.KNeighborsClassifier(n_neighbors=<span class=\"number\">3</span>)</span><br><span class=\"line\">model.fit(x_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•å’Œè¯„ä¼°</span></span><br><span class=\"line\">prediction = model.predict(x_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(y_test, prediction))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606202144425.png\"  style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=41&amp;vd_source=fe8e916be2bd597efffd8dfd95249141\">KNNç®—æ³•</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/",
            "title": "é€»è¾‘å›å½’",
            "date_published": "2023-06-05T13:32:23.000Z",
            "content_html": "<h1 id=\"é€»è¾‘å›å½’logistic-regression\"><a href=\"https://baike.baidu.com/item/logistic%E5%9B%9E%E5%BD%92/2981575?fromtitle=%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92&amp;fromid=17202449&amp;fr=aladdin\">é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰</a></h1>\r\n<p>æ˜¯ä¸€ç§å¹¿ä¹‰çš„çº¿æ€§å›å½’åˆ†ææ¨¡å‹ï¼Œä¸å¤šé‡çº¿æ€§å›å½’æœ‰å¾ˆå¤šç›¸åŒä¹‹å¤„ã€‚å®ƒä»¬çš„æ¨¡å‹å½¢å¼åŸºæœ¬ä¸Šç›¸åŒï¼Œéƒ½å…·æœ‰$ wâ€™x+b$ï¼Œå…¶åŒºåˆ«åœ¨äºä»–ä»¬çš„å› å˜é‡ä¸åŒï¼Œ</p>\r\n<ul>\r\n<li>å¤šé‡çº¿æ€§å›å½’ç›´æ¥å°†<span class=\"math inline\">\\(w&#39;x+b\\)</span>ä½œä¸ºå› å˜é‡ï¼Œ</li>\r\n<li>Logisticå›å½’åˆ™é€šè¿‡å‡½æ•°Lå°†<span class=\"math inline\">\\(w&#39;x+b\\)</span>å¯¹åº”ä¸€ä¸ªéšçŠ¶æ€<span class=\"math inline\">\\(p\\)</span>ï¼Œ<span class=\"math inline\">\\(p =L(w&#39;x+b)\\)</span>ï¼Œç„¶åæ ¹æ®<span class=\"math inline\">\\(p\\)</span>ä¸<span class=\"math inline\">\\(1-p\\)</span>çš„å¤§å°å†³å®šå› å˜é‡çš„å€¼ã€‚</li>\r\n</ul>\r\n<p>å¦‚æœLæ˜¯Logisticå‡½æ•°ï¼Œå°±æ˜¯Logisticå›å½’ï¼Œ</p>\r\n<p>å¦‚æœLæ˜¯å¤šé¡¹å¼å‡½æ•°å°±æ˜¯å¤šé¡¹å¼å›å½’ã€‚</p>\r\n<span id=\"more\"></span>\r\n<h2 id=\"logistic-function\">Logistic Function</h2>\r\n<p>å®šä¹‰é€»è¾‘å›å½’çš„é¢„æµ‹å‡½æ•°ä¸º<span class=\"math inline\">\\(â„_\\theta(x) = ğ‘”(\\theta^ğ‘‡ğ‘¥)\\)</span> ï¼Œå…¶ä¸­g(x)å‡½æ•°æ˜¯sigmoidå‡½æ•°ã€‚ <span class=\"math display\">\\[\r\ng(x)=\\frac{1}{1+e^{-x}}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nh_\\theta(x)=\\frac{1}{1+e^{-\\theta^Tx}}\r\n\\]</span></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606093600860.png\"  style=\"zoom:50%;\" /></p>\r\n<ol type=\"1\">\r\n<li>å½“<span class=\"math inline\">\\(\\theta^Txâ‰¥0\\)</span>ï¼Œ<span class=\"math inline\">\\(g(\\theta^Tx)â‰¥0.5\\)</span></li>\r\n<li>å½“<span class=\"math inline\">\\(\\theta^Txâ‰¤0\\)</span>ï¼Œ<span class=\"math inline\">\\(g(\\theta^Tx)â‰¤0.5\\)</span></li>\r\n</ol>\r\n<h2 id=\"é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°cost-function\">é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰</h2>\r\n<p><span class=\"math display\">\\[\r\nCost(h_\\theta(x),y)= \r\n\\begin{cases}\r\n-log(h_\\theta(x))\\quad\\quad\\quad if\\quad y=1\\\\\r\n-log(1-h_\\theta(x))\\quad if\\quad y=0\r\n\\end{cases}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=-ylog(h_\\theta(x))-(1-y)log(1-h_\\theta(x))\r\n\\]</span></p>\r\n<h2 id=\"æ¢¯åº¦ä¸‹é™æ³•gradient-descent\">æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰</h2>\r\n<p><span class=\"math display\">\\[\r\nJ(\\theta)=-\\frac{1}{m}[\\sum_{i=1}^{m}y^{(i)}logh_\\theta(x^{(i)})+(1-y^{(i)})log(1-h_\\theta(x^{(i)}))]\r\n\\]</span></p>\r\n<p>æ±‚è§£ <span class=\"math inline\">\\(min_\\theta J(\\theta)\\)</span> <span class=\"math display\">\\[\r\n\\theta_j:=\\theta_j-\\alpha\\sum_{i=1}^{m}(h_\\theta(x^{(i)})-y^{(i)})x_j^{(i)}\r\n\\]</span></p>\r\n<h2 id=\"å‡†ç¡®ç‡ç²¾å‡†ç‡å¬å›ç‡f1åˆ†æ•°\">å‡†ç¡®ç‡|ç²¾å‡†ç‡|å¬å›ç‡|F<sub>1</sub>åˆ†æ•°</h2>\r\n<p>æ··æ·†çŸ©é˜µ</p>\r\n<table>\r\n<thead>\r\n<tr class=\"header\">\r\n<th></th>\r\n<th></th>\r\n<th>å®é™…</th>\r\n<th>å®é™…</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td></td>\r\n<td></td>\r\n<td>1</td>\r\n<td>0</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td>é¢„æµ‹</td>\r\n<td>1</td>\r\n<td>TP</td>\r\n<td>FP</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td>é¢„æµ‹</td>\r\n<td>0</td>\r\n<td>FN</td>\r\n<td>TN</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<ul>\r\n<li>Pï¼ˆPositiveï¼‰ï¼šä»£è¡¨1</li>\r\n<li>Nï¼ˆNegativeï¼‰ï¼šä»£è¡¨0</li>\r\n<li>Tï¼ˆTrueï¼‰ï¼šä»£è¡¨é¢„æµ‹æ­£ç¡®</li>\r\n<li>Fï¼ˆFalseï¼‰ï¼šä»£è¡¨é¢„æµ‹é”™è¯¯</li>\r\n</ul>\r\n<p><strong>å‡†ç¡®ç‡ï¼š</strong>å³é¢„æµ‹æ­£ç¡®çš„ç»“æœå æ€»æ ·æœ¬çš„ç™¾åˆ†æ¯” <span class=\"math display\">\\[\r\nå‡†ç¡®ç‡=\\frac{TP+TN}{TP+TN+FP+FN}\r\n\\]</span> <strong>ç²¾å‡†ç‡ï¼ˆPrecisionï¼‰ï¼š</strong>æ˜¯æŒ‡åœ¨æ‰€æœ‰è¢«é¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­å®é™…ä¸ºæ­£çš„æ ·æœ¬çš„æ¦‚ç‡ã€‚ <span class=\"math display\">\\[\r\nç²¾å‡†ç‡=\\frac{TP}{TP+FP}\r\n\\]</span> <strong>ç²¾å‡†ç‡å°±æ˜¯ä½ è®¤ä¸ºæ‰¾çš„æ˜¯å¯¹çš„å®é™…ä¸Šå¤šå°‘æ˜¯å¯¹çš„</strong></p>\r\n<p><strong>å¬å›ç‡ï¼ˆRecallï¼‰ï¼š</strong>æ˜¯æŒ‡åœ¨å®é™…ä¸ºæ­£çš„æ ·æœ¬ä¸­è¢«é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚ <span class=\"math display\">\\[\r\nå¬å›ç‡=\\frac{TP}{TP+FN}\r\n\\]</span> <strong>F<sub>1</sub>åˆ†æ•°ï¼š</strong>ç²¾å‡†ç‡å’Œå¬å›ç‡ä¹‹é—´çš„ä¸€ä¸ªå¹³è¡¡ç‚¹ã€‚ <span class=\"math display\">\\[\r\nF_1=\\frac{2\\times Precision\\times Recall}{Precision+Recall}\r\n\\]</span></p>\r\n<h2 id=\"é€»è¾‘å›å½’ç¤ºä¾‹ä»£ç \">é€»è¾‘å›å½’ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> classification_report</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> preprocessing</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model</span><br><span class=\"line\"><span class=\"comment\"># æ•°æ®æ˜¯å¦éœ€è¦æ ‡å‡†åŒ–</span></span><br><span class=\"line\">scale = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;LR-testSet.csv&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,:-<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[:,-<span class=\"number\">1</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot</span>():</span><br><span class=\"line\">    x0 = []</span><br><span class=\"line\">    x1 = []</span><br><span class=\"line\">    y0 = []</span><br><span class=\"line\">    y1 = []</span><br><span class=\"line\">    <span class=\"comment\"># åˆ‡åˆ†ä¸åŒç±»åˆ«çš„æ•°æ®</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(x_data)):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> y_data[i]==<span class=\"number\">0</span>:</span><br><span class=\"line\">            x0.append(x_data[i,<span class=\"number\">0</span>])</span><br><span class=\"line\">            y0.append(x_data[i,<span class=\"number\">1</span>])</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            x1.append(x_data[i,<span class=\"number\">0</span>])</span><br><span class=\"line\">            y1.append(x_data[i,<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">   scatter0 = plt.scatter(x0, y0, c=<span class=\"string\">&#x27;c&#x27;</span>, marker=<span class=\"string\">&#x27;+&#x27;</span>)</span><br><span class=\"line\">    scatter1 = plt.scatter(x1, y1, c=<span class=\"string\">&#x27;y&#x27;</span>, marker=<span class=\"string\">&#x27;*&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\">#ç”»å›¾ä¾‹</span></span><br><span class=\"line\">    plt.legend(handles=[scatter0,scatter1],labels=[<span class=\"string\">&#x27;label0&#x27;</span>,<span class=\"string\">&#x27;label1&#x27;</span>],loc=<span class=\"string\">&#x27;best&#x27;</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">plot()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">logistic = linear_model.LogisticRegression()</span><br><span class=\"line\">logistic.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> scale == <span class=\"literal\">False</span>:</span><br><span class=\"line\">    <span class=\"comment\"># ç”»å›¾å†³ç­–è¾¹ç•Œ</span></span><br><span class=\"line\">    plot()</span><br><span class=\"line\">    x_test = np.array([[-<span class=\"number\">4</span>],[<span class=\"number\">3</span>]])</span><br><span class=\"line\">    y_test = (-logistic.intercept_ - x_test*logistic.coef_[<span class=\"number\">0</span>][<span class=\"number\">0</span>])/logistic.coef_[<span class=\"number\">0</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    plt.plot(x_test, y_test, <span class=\"string\">&#x27;k&#x27;</span>)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•ä¸è¯„ä¼°    </span></span><br><span class=\"line\">predictions = logistic.predict(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(y_data, predictions))</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606164354040.png\"  style=\"zoom:50%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606164557574.png\"  style=\"zoom: 67%;\" /></p>\r\n<h2 id=\"éçº¿æ€§é€»è¾‘å›å½’ç¤ºä¾‹ä»£ç \">éçº¿æ€§é€»è¾‘å›å½’ç¤ºä¾‹ä»£ç </h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.datasets <span class=\"keyword\">import</span> make_gaussian_quantiles</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> PolynomialFeatures</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆ2ç»´æ­£æ€åˆ†å¸ƒï¼Œç”Ÿæˆçš„æ•°æ®æŒ‰åˆ†ä½æ•°åˆ†ä¸ºä¸¤ç±»ï¼Œ500ä¸ªæ ·æœ¬,2ä¸ªæ ·æœ¬ç‰¹å¾</span></span><br><span class=\"line\"><span class=\"comment\"># å¯ä»¥ç”Ÿæˆä¸¤ç±»æˆ–å¤šç±»æ•°æ®</span></span><br><span class=\"line\">x_data, y_data = make_gaussian_quantiles(n_samples=<span class=\"number\">500</span>, n_features=<span class=\"number\">2</span>,n_classes=<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">logistic = linear_model.LogisticRegression()</span><br><span class=\"line\">logistic.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰å¤šé¡¹å¼å›å½’,degreeçš„å€¼å¯ä»¥è°ƒèŠ‚å¤šé¡¹å¼çš„ç‰¹å¾</span></span><br><span class=\"line\">poly_reg  = PolynomialFeatures(degree=<span class=\"number\">5</span>) </span><br><span class=\"line\"><span class=\"comment\"># ç‰¹å¾å¤„ç†</span></span><br><span class=\"line\">x_poly = poly_reg.fit_transform(x_data)</span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰é€»è¾‘å›å½’æ¨¡å‹</span></span><br><span class=\"line\">logistic = linear_model.LogisticRegression()</span><br><span class=\"line\"><span class=\"comment\"># è®­ç»ƒæ¨¡å‹</span></span><br><span class=\"line\">logistic.fit(x_poly, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–æ•°æ®å€¼æ‰€åœ¨çš„èŒƒå›´</span></span><br><span class=\"line\">x_min, x_max = x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">y_min, y_max = x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span>, x_data[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class=\"number\">0.02</span>),</span><br><span class=\"line\">                     np.arange(y_min, y_max, <span class=\"number\">0.02</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">z = logistic.predict(poly_reg.fit_transform(np.c_[xx.ravel(), yy.ravel()]))<span class=\"comment\"># ravelä¸flattenç±»ä¼¼ï¼Œå¤šç»´æ•°æ®è½¬ä¸€ç»´ã€‚flattenä¸ä¼šæ”¹å˜åŸå§‹æ•°æ®ï¼Œravelä¼šæ”¹å˜åŸå§‹æ•°æ®</span></span><br><span class=\"line\">z = z.reshape(xx.shape)</span><br><span class=\"line\"><span class=\"comment\"># ç­‰é«˜çº¿å›¾</span></span><br><span class=\"line\">cs = plt.contourf(xx, yy, z)</span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">plt.scatter(x_data[:, <span class=\"number\">0</span>], x_data[:, <span class=\"number\">1</span>], c=y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;score:&#x27;</span>,logistic.score(x_poly,y_data))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230606165631817.png\"  style=\"zoom:67%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=29\">é€»è¾‘å›å½’</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%8F%8A%E9%9D%9E%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/",
            "url": "https://liujk6525.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%8F%8A%E9%9D%9E%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/",
            "title": "çº¿æ€§å›å½’åŠéçº¿æ€§å›å½’",
            "date_published": "2023-06-05T01:37:27.000Z",
            "content_html": "<h1 id=\"åŸºæœ¬æ¦‚å¿µ\">åŸºæœ¬æ¦‚å¿µï¼š</h1>\r\n<p>å°†æ•°æ®åˆ’åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<span class=\"math inline\">\\(\\begin{cases} è®­ç»ƒé›†(Train):ç”¨æ¥è®­ç»ƒï¼Œæ„å»ºæ¨¡å‹\\\\ éªŒè¯é›†(Validate):åœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µï¼Œæµ‹è¯•æ¨¡å‹çš„å¥½å\\\\ æµ‹è¯•é›†(Test):ç­‰æ¨¡å‹è®­ç»ƒå¥½åï¼Œè¯„ä¼°æ¨¡å‹çš„å¥½å \\end{cases}\\)</span></p>\r\n<span id=\"more\"></span>\r\n<p>å­¦ä¹ æ–¹å¼ï¼š<span class=\"math inline\">\\(\\begin{cases} ç›‘ç£å­¦ä¹ \\\\ æ— ç›‘ç£å­¦ä¹ \\\\ åŠç›‘ç£å­¦ä¹  \\end{cases}\\)</span></p>\r\n<p>å¸¸è§åº”ç”¨ï¼š<span class=\"math inline\">\\(\\begin{cases} å›å½’ï¼šé¢„æµ‹æ•°æ®ä¸ºè¿ç»­å‹æ•°å€¼ã€‚\\\\ åˆ†ç±»ï¼šé¢„æµ‹æ•°æ®ä¸ºç±»åˆ«å‹æ•°æ®ï¼Œå¹¶ä¸”ç±»åˆ«å·²çŸ¥ã€‚\\\\ èšç±»ï¼šé¢„æµ‹æ•°æ®ä¸ºç±»åˆ«å‹æ•°æ®ï¼Œä½†æ˜¯ç±»åˆ«æœªçŸ¥ã€‚ \\end{cases}\\)</span></p>\r\n<h1 id=\"å›å½’åˆ†æregression\"><a href=\"https://baike.baidu.com/item/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/2625498?fr=aladdin\">å›å½’åˆ†æï¼ˆRegressionï¼‰</a></h1>\r\n<p>å›å½’åˆ†æç”¨æ¥å»ºç«‹æ–¹ç¨‹ï¼Œæ¨¡æ‹Ÿä¸¤ä¸ªæˆ–è€…å¤šä¸ªå˜é‡ä¹‹é—´å¦‚ä½•å…³è”ï¼Œ</p>\r\n<ul>\r\n<li>è¢«é¢„æµ‹çš„å˜é‡å«åšï¼šå› å˜é‡/è¾“å‡º</li>\r\n<li>è¢«ç”¨æ¥è¿›è¡Œé¢„æµ‹çš„å˜é‡å«åšï¼š è‡ªå˜é‡,/è¾“å…¥</li>\r\n</ul>\r\n<p>ä¸€å…ƒçº¿æ€§å›å½’åŒ…å«ä¸€ä¸ªè‡ªå˜é‡å’Œä¸€ä¸ªå› å˜é‡ï¼Œä¸¤ä¸ªå˜é‡çš„å…³ç³»ç”¨ä¸€æ¡ç›´çº¿æ¥æ¨¡æ‹Ÿï¼Œå¦‚æœåŒ…å«ä¸¤ä¸ªä»¥ä¸Šçš„è‡ªå˜é‡ï¼Œåˆ™ç§°ä½œå¤šå…ƒå›å½’åˆ†æï¼ˆmultiple regressionï¼‰</p>\r\n<h1 id=\"ä¸€å…ƒçº¿æ€§å›å½’\"><a href=\"https://baike.baidu.com/item/%E4%B8%80%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/22770888?fr=aladdin\">ä¸€å…ƒçº¿æ€§å›å½’</a></h1>\r\n<p>ä¸€å…ƒçº¿æ€§å›å½’ï¼š<span class=\"math inline\">\\(h_\\theta(x)=\\theta_0+\\theta_1x\\)</span></p>\r\n<h2 id=\"ä»£ä»·å‡½æ•°cost-function\"><a href=\"https://baike.baidu.com/item/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/1783236?fromtitle=%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0&amp;fromid=7048599&amp;fr=aladdin\">ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰</a></h2>\r\n<p><strong>æœ€å°äºŒä¹˜æ³•</strong></p>\r\n<p>å‡è®¾çœŸå®å€¼ä¸º<span class=\"math inline\">\\(y\\)</span>ï¼Œé¢„æµ‹å€¼<span class=\"math inline\">\\(h_\\theta(x)\\)</span> ï¼Œåˆ™è¯¯å·®å¹³æ–¹ä¸º<span class=\"math inline\">\\((h_\\theta(x)-y)^2\\)</span></p>\r\n<p>æ‰¾åˆ°åˆé€‚çš„å‚æ•°ï¼Œä½¿å¾—è¯¯å·®å¹³æ–¹å’Œ<span class=\"math inline\">\\(J(\\theta_0,\\theta_1)\\)</span>æœ€å°ã€‚ <span class=\"math display\">\\[\r\nJ(\\theta_0,\\theta_1)=\\frac{1}{2m}\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})^{2}}\r\n\\]</span></p>\r\n<h2 id=\"æ¢¯åº¦ä¸‹é™æ³•gradient-descent\"><a href=\"https://baike.baidu.com/item/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/8641233?fr=aladdin\">æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰</a></h2>\r\n<p><strong>æœ€å°åŒ–ç›®æ ‡å‡½æ•°</strong> <span class=\"math inline\">\\(\\underset{\\theta_0,\\theta_1}{min}\\quad J(\\theta_0,\\theta_1)\\)</span></p>\r\n<p>åˆå§‹åŒ–å‚æ•°<span class=\"math inline\">\\(\\theta_0,\\theta_1\\)</span></p>\r\n<p>ä¸æ–­æ”¹å˜<span class=\"math inline\">\\(\\theta_0,\\theta_1\\)</span> ï¼Œç›´åˆ°<span class=\"math inline\">\\(J(\\theta_0,\\theta_1)\\)</span>åˆ°è¾¾ä¸€ä¸ªå…¨å±€æœ€å°å€¼ï¼Œæˆ–å±€éƒ¨æå°å€¼ã€‚ <span class=\"math display\">\\[\r\n\\theta_j:=\\theta_j-\\alpha\\frac{\\partial}{\\partial\\theta_j}J(\\theta_0,\\theta_1)\\quad (j=0,1,2\\cdots)\r\n\\]</span></p>\r\n<h2 id=\"ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£çº¿æ€§å›å½’\">ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£çº¿æ€§å›å½’</h2>\r\n<p><span class=\"math display\">\\[\r\n\\frac{\\partial}{\\partial\\theta_0}J(\\theta_0,\\theta_1)=\r\n\\frac{1}{m}\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})}\r\n\\\\\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n\\frac{\\partial}{\\partial\\theta_1}J(\\theta_0,\\theta_1)=\r\n\\frac{1}{m}\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})}\\times x^{(i)}\r\n\\]</span></p>\r\n<p>ä¸æ–­è¿­ä»£ï¼Œç›´åˆ°æ”¶æ•›ï¼š <span class=\"math display\">\\[\r\n\\theta_0:=\\theta_0-\\alpha\\frac{1}{m}{\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})}}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n\\theta_1:=\\theta_1-\\alpha\\frac{1}{m}{\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})}}\\times x^{(i)}\r\n\\]</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression <span class=\"comment\"># çº¿æ€§å›å½’æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;data.csv&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[:,<span class=\"number\">0</span>]</span><br><span class=\"line\">y_data = data[:,<span class=\"number\">1</span>]</span><br><span class=\"line\">plt.scatter(x_data,y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\">x_data = data[:,<span class=\"number\">0</span>,np.newaxis]</span><br><span class=\"line\">y_data = data[:,<span class=\"number\">1</span>,np.newaxis]</span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">model = LinearRegression() <span class=\"comment\"># çº¿æ€§å›å½’</span></span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•</span></span><br><span class=\"line\">x_test = [[<span class=\"number\">44.5</span>]]</span><br><span class=\"line\">predict = model.predict(x_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;predict&#x27;</span>,predict)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">plt.plot(x_data, y_data, <span class=\"string\">&#x27;b.&#x27;</span>)</span><br><span class=\"line\">plt.plot(x_data, model.predict(x_data), <span class=\"string\">&#x27;r&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605203607162.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"å¤šå…ƒçº¿æ€§å›å½’multiple-linear-regression\"><a href=\"https://baike.baidu.com/item/%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/10702248?fr=aladdin\">å¤šå…ƒçº¿æ€§å›å½’ï¼ˆMultiple Linear Regressionï¼‰</a></h1>\r\n<p>å¤šç‰¹å¾æ—¶ï¼Œå‡è®¾ï¼š<span class=\"math inline\">\\(h_\\theta(x)=\\theta_0+\\theta_1x_1+\\theta_2x_2+\\cdots+\\theta_nx_n\\)</span></p>\r\n<p>å½“çœŸå®å€¼<span class=\"math inline\">\\(y\\)</span>çš„å½±å“å› ç´ ä¸æ˜¯å”¯ä¸€æ—¶ï¼Œéœ€é‡‡ç”¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ã€‚</p>\r\n<p>ä»£ä»·å‡½æ•°ï¼š <span class=\"math display\">\\[\r\nJ(\\theta_0,\\theta_1,\\cdots,\\theta_n)=\\frac{1}{2m}\\sum_{i=1}^{m}(h_\\theta(x^{(i)})-y^{(i)})^{2}\r\n\\]</span> æ¢¯åº¦ä¸‹é™æ³•ï¼š <span class=\"math display\">\\[\r\n\\theta_j:=\\theta_j-\\alpha\\frac{1}{m}\\sum_{i=1}^{m}{(h_\\theta(x^{(i)})-y^{(i)})}\\times x_j^{(i)}\\quad (j=0,1,2\\cdots,n)\r\n\\]</span> æ³¨æ„è¿™é‡Œçš„<span class=\"math inline\">\\(j=0\\)</span>æ—¶ï¼Œ<span class=\"math inline\">\\(x_0=1\\)</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -1\">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> genfromtxt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model <span class=\"comment\"># çº¿æ€§å›å½’æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt  </span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> Axes3D  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¯»å…¥æ•°æ® </span></span><br><span class=\"line\">data = genfromtxt(<span class=\"string\">r&quot;Delivery.csv&quot;</span>,delimiter=<span class=\"string\">&#x27;,&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡åˆ†æ•°æ®</span></span><br><span class=\"line\">x_data = data[:,:-<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[:,-<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºæ¨¡å‹</span></span><br><span class=\"line\">model = linear_model.LinearRegression()</span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•</span></span><br><span class=\"line\">x_test = [[<span class=\"number\">102</span>,<span class=\"number\">4</span>]]</span><br><span class=\"line\">predict = model.predict(x_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;predict:&quot;</span>,predict)</span><br><span class=\"line\"></span><br><span class=\"line\">ax = plt.figure().add_subplot(<span class=\"number\">111</span>, projection = <span class=\"string\">&#x27;3d&#x27;</span>) </span><br><span class=\"line\">ax.scatter(x_data[:,<span class=\"number\">0</span>], x_data[:,<span class=\"number\">1</span>], y_data, c = <span class=\"string\">&#x27;r&#x27;</span>, marker = <span class=\"string\">&#x27;o&#x27;</span>, s = <span class=\"number\">100</span>) <span class=\"comment\">#ç‚¹ä¸ºçº¢è‰²ä¸‰è§’å½¢  </span></span><br><span class=\"line\">x0 = x_data[:,<span class=\"number\">0</span>]</span><br><span class=\"line\">x1 = x_data[:,<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆç½‘æ ¼çŸ©é˜µ</span></span><br><span class=\"line\">x0, x1 = np.meshgrid(x0, x1)</span><br><span class=\"line\">z = model.intercept_ + x0*model.coef_[<span class=\"number\">0</span>] + x1*model.coef_[<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"comment\"># ç”»3Då›¾</span></span><br><span class=\"line\">ax.plot_surface(x0, x1, z)</span><br><span class=\"line\"><span class=\"comment\">#è®¾ç½®åæ ‡è½´  </span></span><br><span class=\"line\">ax.set_xlabel(<span class=\"string\">&#x27;Miles&#x27;</span>)  </span><br><span class=\"line\">ax.set_ylabel(<span class=\"string\">&#x27;Num of Deliveries&#x27;</span>)  </span><br><span class=\"line\">ax.set_zlabel(<span class=\"string\">&#x27;Time&#x27;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">#æ˜¾ç¤ºå›¾åƒ  </span></span><br><span class=\"line\">plt.show()  </span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605204147960.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"å¤šé¡¹å¼å›å½’\">å¤šé¡¹å¼å›å½’</h1>\r\n<p>å‡å¦‚æˆ‘ä»¬ä¸æ˜¯è¦æ‰¾ç›´çº¿ï¼ˆæˆ–è€…è¶…å¹³é¢ï¼‰ï¼Œè€Œæ˜¯éœ€è¦æ‰¾åˆ°ä¸€ ä¸ªç”¨å¤šé¡¹å¼æ‰€è¡¨ç¤ºçš„æ›²çº¿ï¼ˆæˆ–è€…è¶…æ›²é¢ï¼‰</p>\r\n<p>å¤šé¡¹å¼å›å½’ï¼š<span class=\"math inline\">\\(h_\\theta(x)=\\theta_0+\\theta_1x+\\theta_2x^2+\\cdots+\\theta_nx^n\\)</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -2\">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> PolynomialFeatures </span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½½å…¥æ•°æ®</span></span><br><span class=\"line\">data = np.genfromtxt(<span class=\"string\">&quot;job.csv&quot;</span>, delimiter=<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">x_data = data[<span class=\"number\">1</span>:,<span class=\"number\">1</span>]</span><br><span class=\"line\">y_data = data[<span class=\"number\">1</span>:,<span class=\"number\">2</span>]</span><br><span class=\"line\">plt.scatter(x_data,y_data)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\">x_data = x_data[:,np.newaxis]</span><br><span class=\"line\">y_data = y_data[:,np.newaxis]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰å¤šé¡¹å¼å›å½’,degreeçš„å€¼å¯ä»¥è°ƒèŠ‚å¤šé¡¹å¼çš„ç‰¹å¾</span></span><br><span class=\"line\">poly_reg  = PolynomialFeatures(degree=<span class=\"number\">5</span>) </span><br><span class=\"line\"><span class=\"comment\"># ç‰¹å¾å¤„ç†</span></span><br><span class=\"line\">x_poly = poly_reg.fit_transform(x_data)</span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰å›å½’æ¨¡å‹</span></span><br><span class=\"line\">lin_reg = LinearRegression()</span><br><span class=\"line\"><span class=\"comment\"># è®­ç»ƒæ¨¡å‹</span></span><br><span class=\"line\">lin_reg.fit(x_poly, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">plt.plot(x_data, y_data, <span class=\"string\">&#x27;b.&#x27;</span>)</span><br><span class=\"line\">x_test = np.linspace(<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">100</span>)</span><br><span class=\"line\">x_test = x_test[:,np.newaxis]</span><br><span class=\"line\">plt.plot(x_test, lin_reg.predict(poly_reg.fit_transform(x_test)), c=<span class=\"string\">&#x27;r&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Truth or Bluff (Polynomial Regression)&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Position level&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Salary&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605205328029.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"æ ‡å‡†æ–¹ç¨‹æ³•normal-equation\">æ ‡å‡†æ–¹ç¨‹æ³•ï¼ˆNormal Equationï¼‰</h1>\r\n<p>æ³¨æ„è¿™é‡Œçš„ç¬¦å·ï¼š<span class=\"math inline\">\\(w\\)</span>å…¶å®å°±æ˜¯ä¸Šé¢å…¬å¼é‡Œçš„<span class=\"math inline\">\\(\\theta\\)</span>ï¼Œå°±æ˜¯è¦æ±‚è§£çš„é‚£ä¸ªå‚æ•°ã€‚</p>\r\n<p>å‡è®¾ï¼š <span class=\"math display\">\\[\r\nh_w(x)=w_0+w_1x_1+w_2x_2+\\cdots+w_nx_n\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nh_w(x)=xw\\\r\n\\]</span></p>\r\n<p>ç›®æ ‡å‡½æ•°: <span class=\"math display\">\\[\r\nJ(w_0,w_1,\\cdots,w_n)=\\frac{1}{2m}\\sum_{i=1}^{m}(h_w(x^{(i)})-y^{(i)})^{2}\r\n\\]</span> åˆå› ä¸º <span class=\"math display\">\\[\r\n\\sum_{i=1}^{m}(h_w(x^{(i)})-y^{(i)})^{2}=(y-Xw)^T(y-Xw)\r\n\\]</span> æ‰€ä»¥ <span class=\"math display\">\\[\r\n\\frac{\\partial J(w)}{\\partial w}=\\frac{\\partial(y-Xw)^T(y-Xw)}{\\partial w}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=\\frac{\\partial(y^Ty-y^TXw-w^TX^Ty+w^TX^TXw)}{\\partial w}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=\\frac{\\partial(y^Ty)}{\\partial w}-\\frac{\\partial(y^TXw)}{\\partial w}-\\frac{\\partial(w^TX^Ty)}{\\partial w}+\\frac{\\partial(w^TX^TXw)}{\\partial w}\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=0-X^Ty-X^Ty+2X^TXw\r\n\\]</span></p>\r\n<p>ä»¤ <span class=\"math display\">\\[\r\n\\frac{\\partial J(w)}{\\partial w}=0\r\n\\]</span> æ±‚è§£ï¼š <span class=\"math display\">\\[\r\n-2X^Ty+2X^TXw=0\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nX^TXw=X^Ty\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nw=(X^TX)^{-1}X^Ty\r\n\\]</span></p>\r\n<h1 id=\"ç‰¹å¾ç¼©æ”¾\"><a href=\"https://baike.baidu.com/item/%E7%89%B9%E5%BE%81%E7%BC%A9%E6%94%BE/17415222?fr=aladdin\">ç‰¹å¾ç¼©æ”¾</a></h1>\r\n<h2 id=\"æ•°æ®å½’ä¸€åŒ–\">æ•°æ®å½’ä¸€åŒ–</h2>\r\n<p>æ•°æ®å½’ä¸€åŒ–å°±æ˜¯æŠŠæ•°æ®çš„å–å€¼èŒƒå›´å¤„ç†ä¸º<span class=\"math inline\">\\(0-1\\)</span>ï¼Œæˆ–è€…<span class=\"math inline\">\\(-1-1\\)</span>ä¹‹é—´ã€‚</p>\r\n<p>ä»»æ„æ•°æ®è½¬åŒ–ä¸º0-1ä¹‹é—´ï¼š <span class=\"math display\">\\[\r\nNewValue = \\frac{OldValue-min}{max-min}\r\n\\]</span> ä»»æ„æ•°æ®è½¬åŒ–ä¸º-1-1ä¹‹é—´ï¼š <span class=\"math display\">\\[\r\nNewValue=2\\times(\\frac{OldVaule-min}{max-min}-0.5)\r\n\\]</span></p>\r\n<h2 id=\"å‡å€¼æ ‡å‡†åŒ–\">å‡å€¼æ ‡å‡†åŒ–</h2>\r\n<p><span class=\"math inline\">\\(x\\)</span>ä¸ºç‰¹å¾æ•°æ®ï¼Œ<span class=\"math inline\">\\(u\\)</span>ä¸ºæ•°æ®çš„å¹³å‡å€¼ï¼Œ<span class=\"math inline\">\\(s\\)</span>ä¸ºæ•°æ®çš„æ–¹å·®ã€‚ <span class=\"math display\">\\[\r\nNewValue=\\frac{OldValue-u}{s}\r\n\\]</span></p>\r\n<h1 id=\"è¿‡æ‹Ÿåˆoverfitting\">è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰</h1>\r\n<p>å›å½’é—®é¢˜æ‹Ÿåˆæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605154335888.png\"  style=\"zoom:50%;\" /></p>\r\n<p>åˆ†ç±»é—®é¢˜æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605154600447.png\" style=\"zoom:50%;\" /></p>\r\n<p>é˜²æ­¢è¿‡æ‹Ÿåˆï¼šå‡å°‘ç‰¹å¾ï¼›å¢åŠ æ•°æ®é‡ï¼›æ­£åˆ™åŒ–ï¼ˆRegularizedï¼‰</p>\r\n<h2 id=\"æ­£åˆ™åŒ–\">æ­£åˆ™åŒ–</h2>\r\n<p>L2æ­£åˆ™åŒ–ï¼š <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2m}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{\\theta_j^2}}]\r\n\\]</span> L1æ­£åˆ™åŒ–ï¼š <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2m}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{|\\theta_j|}}]\r\n\\]</span></p>\r\n<h1 id=\"å²­å›å½’ridge-regression\"><a href=\"https://baike.baidu.com/link?url=J428YjCOAduEv-hDj1BM53FvjQEMC1iR9icG161YvlKwmXXmtsgGoFBvkL_VK2T40KfCjPMUpQQ8ePln0cjp50QpceYEGvvCC4iewQhwY0fGCqcS9kwQCLnbARBjd0mT\">å²­å›å½’ï¼ˆRidge Regressionï¼‰</a></h1>\r\n<p>ç”±æ ‡å‡†æ–¹ç¨‹æ³•å¾—å‡ºï¼Œ <span class=\"math display\">\\[\r\nw = (ğ‘‹^ğ‘‡ğ‘‹)^{-1}ğ‘‹^ğ‘‡y\r\n\\]</span> å¦‚æœæ•°æ®çš„ç‰¹å¾æ¯”æ ·æœ¬ç‚¹è¿˜å¤šï¼Œï¼ˆæ•°æ®ç‰¹å¾<span class=\"math inline\">\\(n\\)</span>ï¼Œæ ·æœ¬ä¸ªæ•°<span class=\"math inline\">\\(m\\)</span>ï¼‰ï¼Œå¦‚æœ<span class=\"math inline\">\\(n&gt;m\\)</span>ï¼Œ<span class=\"math inline\">\\(ğ‘‹^ğ‘‡ğ‘‹\\)</span>ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œä¸å¯é€†ï¼Œè®¡ç®—<span class=\"math inline\">\\(ğ‘‹^ğ‘‡ğ‘‹^{-1}\\)</span>æ—¶ä¼šå‡ºé”™ã€‚</p>\r\n<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†å²­å›å½’çš„æ¦‚å¿µã€‚<span class=\"math inline\">\\(\\lambda\\)</span>ä¸ºå²­ç³»æ•°ï¼Œ<span class=\"math inline\">\\(I\\)</span>ä¸ºå•ä½çŸ©é˜µã€‚ <span class=\"math display\">\\[\r\nw = (ğ‘‹^ğ‘‡ğ‘‹ + \\lambda I)^{-1}ğ‘‹^ğ‘‡y\r\n\\]</span> æ¨å¯¼ï¼š <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{\\theta_j^2}}]\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=\\frac{1}{2}(Xw-y)^T(Xw-y)+\\lambda w^Tw\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n=\\frac{1}{2}(w^TX^TXw-w^TX^Ty-y^TXw+y^Ty)+\\lambda w^Tw\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n\\frac{\\partial J(w)}{\\partial w}=X^TXw-X^Ty+\\lambda w\r\n\\]</span></p>\r\n<p>ä»¤ <span class=\"math display\">\\[\r\n\\frac{\\partial J(w)}{\\partial w}=0\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\nw = (ğ‘‹^ğ‘‡ğ‘‹ + \\lambda I)^{-1}ğ‘‹^ğ‘‡y\r\n\\]</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -3\">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> genfromtxt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¯»å…¥æ•°æ® </span></span><br><span class=\"line\">data = genfromtxt(<span class=\"string\">r&quot;longley.csv&quot;</span>,delimiter=<span class=\"string\">&#x27;,&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡åˆ†æ•°æ®</span></span><br><span class=\"line\">x_data = data[<span class=\"number\">1</span>:,<span class=\"number\">2</span>:]</span><br><span class=\"line\">y_data = data[<span class=\"number\">1</span>:,<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºæ¨¡å‹</span></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆ50ä¸ªå€¼</span></span><br><span class=\"line\">alphas_to_test = np.linspace(<span class=\"number\">0.001</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºæ¨¡å‹ï¼Œä¿å­˜è¯¯å·®å€¼</span></span><br><span class=\"line\">model = linear_model.RidgeCV(alphas=alphas_to_test, store_cv_values=<span class=\"literal\">True</span>)</span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\"><span class=\"comment\"># å²­ç³»æ•°è·Ÿlosså€¼çš„å…³ç³»</span></span><br><span class=\"line\">plt.plot(alphas_to_test, model.cv_values_.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"comment\"># é€‰å–çš„å²­ç³»æ•°å€¼çš„ä½ç½®</span></span><br><span class=\"line\">plt.plot(model.alpha_, <span class=\"built_in\">min</span>(model.cv_values_.mean(axis=<span class=\"number\">0</span>)),<span class=\"string\">&#x27;ro&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;alphas&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;loss&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•</span></span><br><span class=\"line\">model.predict(x_data[<span class=\"number\">2</span>,np.newaxis])</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230605210828441.png\"  style=\"zoom:50%;\" /></p>\r\n<h1 id=\"lassoleast-absolute-shrinkage-and\">[LASSOï¼ˆLeast Absolute Shrinkage and</h1>\r\n<p>Selectionator operatorï¼‰](https://baike.baidu.com/item/Lasso%E7%AE%97%E6%B3%95/22685468?fromtitle=LASSO&amp;fromid=20366865&amp;fr=aladdin)</p>\r\n<p>LASSOçš„ä»£ä»·å‡½æ•°ï¼š <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2m}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{|\\theta_j|}}]\r\n\\]</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -4\">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> genfromtxt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¯»å…¥æ•°æ® </span></span><br><span class=\"line\">data = genfromtxt(<span class=\"string\">r&quot;longley.csv&quot;</span>,delimiter=<span class=\"string\">&#x27;,&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡åˆ†æ•°æ®</span></span><br><span class=\"line\">x_data = data[<span class=\"number\">1</span>:,<span class=\"number\">2</span>:]</span><br><span class=\"line\">y_data = data[<span class=\"number\">1</span>:,<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">model = linear_model.LassoCV()</span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># lassoç³»æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(model.alpha_)</span><br><span class=\"line\"><span class=\"comment\"># ç›¸å…³ç³»æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(model.coef_)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é¢„æµ‹</span></span><br><span class=\"line\">model.predict(x_data[-<span class=\"number\">2</span>,np.newaxis])</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"å¼¹æ€§ç½‘elastic-net\">å¼¹æ€§ç½‘ï¼ˆElastic Netï¼‰</h1>\r\n<p>åœ¨<span class=\"math inline\">\\(q\\)</span>å–ä¸åŒå€¼æƒ…å†µä¸‹çš„ä»£ä»·å‡½æ•° <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2m}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{|\\theta_j|^q}}]\r\n\\]</span> <img src=\"/imgs/$%7Bfiilename%7D/image-20230605164458909.png\"  style=\"zoom:50%;\" /></p>\r\n<p>Elastic Netçš„ä»£ä»·å‡½æ•°ï¼š <span class=\"math display\">\\[\r\nJ(\\theta)=\\frac{1}{2m}[\\sum_{i=1}^{m}{h_\\theta(x^{(i)}-y^{(i)})^2+\\lambda\\sum_{j=1}^{n}{\\alpha\\theta_j^2+(1-\\alpha)|\\theta_j|}}]\r\n\\]</span></p>\r\n<h2 id=\"ç¤ºä¾‹ä»£ç -5\">ç¤ºä¾‹ä»£ç ï¼š</h2>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> genfromtxt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> linear_model</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¯»å…¥æ•°æ® </span></span><br><span class=\"line\">data = genfromtxt(<span class=\"string\">r&quot;longley.csv&quot;</span>,delimiter=<span class=\"string\">&#x27;,&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ‡åˆ†æ•°æ®</span></span><br><span class=\"line\">x_data = data[<span class=\"number\">1</span>:,<span class=\"number\">2</span>:]</span><br><span class=\"line\">y_data = data[<span class=\"number\">1</span>:,<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class=\"line\">model = linear_model.ElasticNetCV()</span><br><span class=\"line\">model.fit(x_data, y_data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¼¹æ€§ç½‘ç³»æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(model.alpha_)</span><br><span class=\"line\"><span class=\"comment\"># ç›¸å…³ç³»æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(model.coef_)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é¢„æµ‹</span></span><br><span class=\"line\">model.predict(x_data[-<span class=\"number\">2</span>,np.newaxis])</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://www.bilibili.com/video/BV1Rt411q7WJ?p=23&amp;vd_source=fe8e916be2bd597efffd8dfd95249141\">çº¿æ€§å›å½’åŠå…¶éçº¿æ€§å›å½’</a></p>\r\n",
            "tags": [
                "Python",
                "Jupyter Notebook"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9Assd-pytorch/",
            "url": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9Assd-pytorch/",
            "title": "è·‘é€šssd.pytorch",
            "date_published": "2023-05-31T02:16:02.000Z",
            "content_html": "<p><strong>è¡¥ï¼š</strong></p>\r\n<h1 id=\"expected-a-cuda-device-type-for-generator-but-found-cpu\">Expected a â€˜cudaâ€˜ device type for generator but found â€˜cpuâ€˜</h1>\r\n<p>åæ¥æˆ‘åœ¨æœåŠ¡å™¨è®­ç»ƒçš„æ—¶å€™ï¼Œå‘ç°å‡ºbugäº†ã€‚åŸæ¥æ˜¯<code>Pytorch</code>ç‰ˆæœ¬çš„åŸå› ï¼Œæˆ‘åœ¨<code>faster-rcnn-pytorch</code>è¿™ä¸ªé¡¹ç›®è·‘çš„ï¼Œé‡Œé¢æœ‰ç°æˆçš„VOCæ•°æ®é›†ã€‚ä½†æ˜¯è¿™ä¸ªç¯å¢ƒ<code>Pytorch</code>æ˜¯1.9ã€‚</p>\r\n<ol type=\"1\">\r\n<li><p>ä¿®æ”¹<code>/root/miniconda3/lib/python3.7/site-packages/torch/utils/data/sampler.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">generator = torch.Generator(device=<span class=\"string\">&#x27;cuda&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">yield</span> <span class=\"keyword\">from</span> torch.randperm(n, generator=generator, device=<span class=\"string\">&#x27;cuda&#x27;</span>).tolist()</span><br></pre></td></tr></table></figure>\r\n<span id=\"more\"></span></li>\r\n<li><p>ä¿®æ”¹<code>train.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data_loader = data.DataLoader(dataset, args.batch_size,</span><br><span class=\"line\">                                  num_workers=args.num_workers,</span><br><span class=\"line\">                                  shuffle=<span class=\"literal\">True</span>, collate_fn=detection_collate,</span><br><span class=\"line\">                                  pin_memory=<span class=\"literal\">True</span>, generator=torch.Generator(device=<span class=\"string\">&#x27;cuda&#x27;</span>))</span><br></pre></td></tr></table></figure></li>\r\n</ol>\r\n<h1 id=\"w-pthreadpool-cpp.cc90-warningleaking-caffe2-thread-pool-after-fork.function-pthreadpool\">[W pthreadpool-cpp.cc:90] Warning:Leaking Caffe2 thread-pool after fork.(function pthreadpool)</h1>\r\n<p>çº¿ç¨‹æ’•è£‚ï¼Œå‡ºç°äº†è­¦å‘Šï¼Œè­¦å‘Šæ•°é‡ä¸ºè®¾ç½®çš„çº¿ç¨‹æ•°é‡ï¼Œå¦‚æœæŠŠçº¿ç¨‹æ•°æ”¹å°ä¸€äº›ï¼Œå°±ä¸ä¼šæœ‰è­¦å‘Šäº†ï¼Œä½†æ˜¯ä¼šå½±å“è¿è¡Œé€Ÿåº¦ã€‚ä¿®æ”¹<code>train.py</code>ä¸­çš„ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data_loader = data.DataLoader(dataset, args.batch_size,</span><br><span class=\"line\">                                 num_workers=args.num_workers,</span><br><span class=\"line\">                                 shuffle=<span class=\"literal\">True</span>, collate_fn=detection_collate,</span><br><span class=\"line\">                                 pin_memory=<span class=\"literal\">False</span>,generator=torch.Generator(device=<span class=\"string\">&#x27;cuda&#x27;</span>))</span><br></pre></td></tr></table></figure>\r\n<hr />\r\n<p>ç„¶åæˆ‘æƒ³åœ¨æœåŠ¡å™¨ä¸Šç”¨<code>visdom</code>çœ‹è®­ç»ƒç»“æœå›¾ï¼Œbugå‡ºç°äº†ã€‚</p>\r\n<h1 id=\"nameerror-name-viz-is-not-defined\">NameError: name â€˜vizâ€™ is not defined</h1>\r\n<p>ä¿®æ”¹<code>train.py</code>ä¸­çš„ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> visdom</span><br><span class=\"line\"><span class=\"keyword\">global</span> viz</span><br><span class=\"line\">viz = visdom.Visdom()</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"assertionerror-must-define-a-window-to-update\">AssertionError: Must define a window to update</h1>\r\n<p>ä¿®æ”¹<code>train.py</code>ä¸­çš„ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> args.visdom <span class=\"keyword\">and</span> iteration != <span class=\"number\">0</span> <span class=\"keyword\">and</span> (iteration % epoch_size == <span class=\"number\">0</span>):</span><br><span class=\"line\">    epoch += <span class=\"number\">1</span></span><br><span class=\"line\">    update_vis_plot(epoch, loc_loss, conf_loss, epoch_plot, <span class=\"literal\">None</span>,</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"legacy-autograd-function-with-non-static-forward-method-is-deprecated\">Legacy autograd function with non-static forward method is deprecated</h1>\r\n<p>åŸå› æ˜¯å½“å‰ç‰ˆæœ¬è¦æ±‚forwardè¿‡ç¨‹æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥éœ€è¦å°†åŸä»£ç è¿›è¡Œä¿®æ”¹ã€‚</p>\r\n<ol type=\"1\">\r\n<li><p>ä»<a href=\"https://github.com/sayakbanerjee1999/Single-Shot-Object-Detection-Updated/blob/master/detection.py\"><code>Single-Shot-Object-Detection-Updated</code></a>ä¸‹è½½<code>detect.py</code>æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ›¿æ¢æ‰åŸæ¥çš„<code>layers/functions/detection.py</code></p></li>\r\n<li><p>ä¿®æ”¹<code>ssd.py</code>ä¸­çš„ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> phase == <span class=\"string\">&#x27;test&#x27;</span>:</span><br><span class=\"line\">        self.softmax = nn.Softmax(dim=-<span class=\"number\">1</span>)</span><br><span class=\"line\">        self.detect = Detect()</span><br></pre></td></tr></table></figure>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> self.phase == <span class=\"string\">&quot;test&quot;</span>:</span><br><span class=\"line\">        output = self.detect.apply(self.num_classes, <span class=\"number\">0</span>, <span class=\"number\">200</span>, <span class=\"number\">0.01</span>, <span class=\"number\">0.45</span>,</span><br><span class=\"line\">                                   loc.view(loc.size(<span class=\"number\">0</span>), -<span class=\"number\">1</span>, <span class=\"number\">4</span>),  <span class=\"comment\"># loc preds</span></span><br><span class=\"line\">                                   self.softmax(conf.view(-<span class=\"number\">1</span>, self.num_classes)),  <span class=\"comment\"># conf preds</span></span><br><span class=\"line\">                                   self.priors.<span class=\"built_in\">type</span>(<span class=\"built_in\">type</span>(x.data))  <span class=\"comment\"># default boxes</span></span><br><span class=\"line\">                                   )</span><br></pre></td></tr></table></figure></li>\r\n</ol>\r\n<h1 id=\"errno-2-no-such-file-or-directory-test.txt\">[Errno 2] No such file or directory: â€˜test.txtâ€™</h1>\r\n<p>ä¿®æ”¹<code>eval.py</code>ä¸­çš„ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">imgsetpath = os.path.join(args.voc_root, <span class=\"string\">&#x27;VOC2007&#x27;</span>, <span class=\"string\">&#x27;ImageSets&#x27;</span>, <span class=\"string\">&#x27;Main&#x27;</span>, <span class=\"string\">&#x27;&#123;&#125;.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>\r\n<hr />\r\n<p>åšå®éªŒå¯¹æ¯”ï¼Œæ‰€ä»¥éœ€è¦è·‘é€šssdï¼Œè¿™é‡Œéƒ¨ç½²çš„pytrochç‰ˆæœ¬ï¼Œå¤§ä½¬é¡¹ç›®<a href=\"https://github.com/amdegroot/ssd.pytorch\"><code>ssd.pytorch</code></a>ï¼Œä¸­é—´è¸©äº†ä¸å°‘å‘ï¼Œè®°å½•å¦‚ä¸‹</p>\r\n<p>ç›®æ ‡ï¼šssd.pytorch</p>\r\n<p>ç¯å¢ƒï¼šcuda 11.3 | pytorch 1.8.1</p>\r\n<h1 id=\"ä¿®æ”¹xmlæ–‡ä»¶çš„ç»å¯¹è·¯å¾„\">ä¿®æ”¹xmlæ–‡ä»¶çš„ç»å¯¹è·¯å¾„</h1>\r\n<p>è¿™æ˜¯åœ¨ä¹‹å‰çš„ç”µè„‘æ‰“çš„æ ‡ç­¾ï¼Œæ‰€ä»¥VOCæ•°æ®é›†é‡Œé¢çš„æ ‡æ³¨æ–‡ä»¶.xmlé‡Œé¢çš„<code>&lt;path&gt;</code>å€¼è¿˜æ˜¯è€è·¯å¾„ï¼Œ</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230531102209091.png\"  style=\"zoom: 67%;\" /></p>\r\n<p>è¿™é‡Œæˆ‘æ›´æ”¹æˆæ–°çš„è·¯å¾„ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230531102832023.png\"  style=\"zoom: 65%;\" /></p>\r\n<h1 id=\"indexerrorinvalid-index-of-a-0-dim-tensor\">IndexError:invalid index of a 0-dim tensorâ€¦</h1>\r\n<p>ä¿®æ”¹<code>train.py</code>ä¸­ä»£ç ï¼Œ<code>.data[0]</code>å†™æ³•ä¸é€‚ç”¨é«˜ç‰ˆæœ¬çš„Pytorchï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loc_loss += loss_l.item()</span><br><span class=\"line\">conf_loss += loss_c.item()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> iteration % <span class=\"number\">10</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;timer: %.4f sec.&#x27;</span> % (t1 - t0))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;iter &#x27;</span> + <span class=\"built_in\">repr</span>(iteration) + <span class=\"string\">&#x27; || Loss: %.4f ||&#x27;</span> % (loss.item()), end=<span class=\"string\">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"stopinteration\">StopInterationâ€¦</h1>\r\n<p>ä¿®æ”¹<code>train.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    images, targets = <span class=\"built_in\">next</span>(batch_iterator)</span><br><span class=\"line\"><span class=\"keyword\">except</span> StopIteration:</span><br><span class=\"line\">    batch_iterator = <span class=\"built_in\">iter</span>(data_loader)</span><br><span class=\"line\">    images, targets = <span class=\"built_in\">next</span>(batch_iterator)</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"indexerror-the-shape-of-the-mask-14-8732-at-index-0does\">IndexError: The shape of the mask [14, 8732] at index 0doesâ€¦</h1>\r\n<p>äº¤æ¢<code>layers/modules/multibox_loss.py</code>ä¸­ä»£ç ä½ç½®ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loss_c = loss_c.view(num, -1)</span><br><span class=\"line\">loss_c[pos] = 0  # filter out pos boxes for now</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"lossnan\">lossï¼šNAN</h1>\r\n<p>å¦‚æœlrè®¾ç½®è¿‡é«˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´è®­ç»ƒè¿‡ç¨‹ä¸­losså‡ºç°NANçš„æƒ…å†µã€‚å®ƒé»˜è®¤çš„å‚æ•°æ˜¯1e-3ï¼Œæˆ‘è¿™é‡Œå°†å­¦ä¹ ç‡ä¿®æ”¹ä¸º1e-4ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--lr&#x27;</span>, <span class=\"string\">&#x27;--learning-rate&#x27;</span>, default=<span class=\"number\">1e-4</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>,</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"è­¦å‘Š\">è­¦å‘Š</h1>\r\n<p><strong>UserWarning: size_average and reduce args will be deprecated, please use reduction=â€˜sumâ€™ instead. warnings.warn(warning.format(ret))</strong></p>\r\n<p>åœ¨é«˜ç‰ˆæœ¬çš„Pytorchä¸­ï¼Œ<code>size_average</code>å’Œ<code>reduce</code>è¿™ä¸¤ä¸ªå‚æ•°éƒ½å°†ä¸å†æ”¯æŒï¼Œä¿®æ”¹<code>multibox_loss.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">loss_l = F.smooth_l1_loss(loc_p, loc_t, reduction=<span class=\"string\">&#x27;sum&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">loss_c = F.cross_entropy(conf_p, targets_weighted, reduction=<span class=\"string\">&#x27;sum&#x27;</span>)</span><br></pre></td></tr></table></figure>\r\n<p><strong>UserWarning: volatile was removed and now has no effect. Use â€˜with torch.no_grad():â€™ instead.</strong></p>\r\n<p>ç‰ˆæœ¬é—®é¢˜ï¼Œä¿®æ”¹<code>ssd.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">\tself.priors = Variable(self.priorbox.forward())</span><br></pre></td></tr></table></figure>\r\n<p><strong>UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_ .init.xavier_uniform(param)</strong></p>\r\n<p><code>nn.init.xavier_uniform</code>æ˜¯ä»¥å‰çš„ç‰ˆæœ¬ä½¿ç”¨çš„ï¼Œåœ¨é«˜ç‰ˆæœ¬çš„Pytorchä¸­å·²ç»è¢«å¼ƒç”¨ã€‚ä¿®æ”¹<code>train.py</code>ä¸­ä»£ç ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">xavier</span>(<span class=\"params\">param</span>):</span><br><span class=\"line\">    init.xavier_uniform_(param)</span><br></pre></td></tr></table></figure>\r\n<p>å¯ä»¥å‘ç°å¾ˆå¤šè­¦å‘Šå°±æ˜¯ç‰ˆæœ¬ä¸åŒ¹é…çš„é—®é¢˜ï¼Œä½†æˆ‘æ˜¯æŠ±ç€åªè¦èƒ½è¿è¡Œçš„å¿ƒæ€ï¼Œç„¶è€Œ<code>UserWarning</code>åˆå¾ˆå½±å“è§‚æ„Ÿï¼Œé‚£å°±ç›´æ¥å±è”½å®ƒï¼</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> warnings</span><br><span class=\"line\"></span><br><span class=\"line\">warnings.filterwarnings(<span class=\"string\">&#x27;ignore&#x27;</span>)</span><br></pre></td></tr></table></figure>\r\n<p>æˆ–è€…å‘½ä»¤è¡Œæ‰§è¡Œ<code>xx.py</code>è„šæœ¬æ–‡ä»¶</p>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -W ignore xx.py</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"è¿è¡Œtrain.pyæ–‡ä»¶\">è¿è¡Œtrain.pyæ–‡ä»¶</h1>\r\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -W ignore train.py</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230531115820400.png\" style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"amdegroot/ssd.pytorch/issues/421\"><code>amdegroot/ssd.pytorch/issues/421</code></a></p>\r\n<p><a href=\"https://blog.csdn.net/qq_39506912/article/details/116926504?spm=1001.2014.3001.5506\"><code>SSDè®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ï¼ˆpytorchç‰ˆï¼‰</code></a></p>\r\n<p><a href=\"https://www.cnblogs.com/shaoxx333/p/16181651.html\"><code>Pytorchæ­å»ºSSDæ¨¡å‹è¸©å‘é›†é”¦</code></a></p>\r\n<p><a href=\"https://www.yii666.com/blog/407628.html\"><code>SSDè®­ç»ƒæ•°æ®é›†æµç¨‹ï¼ˆå­¦ä¹ è®°å½•ï¼‰</code></a></p>\r\n",
            "tags": [
                "Python",
                "ssd.pytorch"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9AYolo-v5/",
            "url": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9AYolo-v5/",
            "title": "wii11ç³»ç»Ÿè·‘é€šYolo-v5",
            "date_published": "2023-05-27T02:06:35.000Z",
            "content_html": "<p>ä¹‹å‰è·‘Yolo-v5æ˜¯åœ¨æœåŠ¡å™¨è·‘çš„ï¼Œç°åœ¨æŠŠæƒé‡æ–‡ä»¶è·‘å®Œäº†ï¼Œæ­£å¥½æœ€è¿‘æ¢äº†æ–°ç”µè„‘ï¼Œåœ¨æœ¬åœ°éƒ¨ç½²è·‘è·‘çœ‹ï¼Œè®°å½•å¦‚ä¸‹ï¼š</p>\r\n<p>å¤ç°<img src=\"/imgs/$%7Bfiilename%7D/b3809ce4a80e96cf09f6d500abed0fbd_129107_720_720.jpg\"  style=\"zoom:5%;\" />å¤§ä½¬ä»¬çš„é¡¹ç›®ä¹‹å‰ä¸€å®šè¦çœ‹è¿™ä¸ªé¡¹ç›®æ‰€éœ€çš„é…ç½®ç¯å¢ƒï¼Œæ‰å¤§å‘ï¼ï¼ï¼</p>\r\n<p>ç›®æ ‡ï¼šYolo-v5 v6.1ç‰ˆæœ¬</p>\r\n<p>ç¯å¢ƒï¼šcuda 11.3 | pytorch 1.8.1</p>\r\n<span id=\"more\"></span>\r\n<h1 id=\"å®‰è£…anaconda3\">å®‰è£…Anaconda3</h1>\r\n<p><a href=\"https://www.anaconda.com/\"><code>anacondaå®˜ç½‘</code></a></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527104222716.png\" alt=\"image-20230527104222716\" style=\"zoom:33%;\" /></p>\r\n<p>ç›´æ¥ç‚¹å‡»<code>Download</code>ä¸‹è½½å®‰è£…åŒ…ï¼ŒåŒå‡»å®‰è£…</p>\r\n<p>æˆ‘æŠŠ<code>Anaconda</code>å®‰è£…åœ¨Dç›˜äº†</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527105216332.png\"  style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"å®‰è£…cuda\">å®‰è£…CUDA</h1>\r\n<p>å®‰è£…ä¹‹å‰å…ˆçœ‹ä¸‹è‡ªå·±ç”µè„‘é…ç½®æ¡ä»¶ï¼Œåœ¨ç»ˆç«¯è¾“å…¥</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvidia-smi</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527105741395.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>å¯ä»¥çœ‹åˆ°<code>Driver Version: 512.98</code></p>\r\n<p>åœ¨å¯¹ç…§<a href=\"https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html\"><code>nvidiaå®˜ç½‘æ˜¾å¡é©±åŠ¨</code></a>ç»™å‡ºçš„ç‰ˆæœ¬è¦æ±‚é€‰æ‹©CUDAç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯<code>CUDA 11.3</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527110416589.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>ç„¶åæ¥åˆ°<a href=\"https://developer.nvidia.com/cuda-toolkit-archive\"><code>CUDA Toolkit Archive</code></a>ï¼Œ</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527111819649.png\"  style=\"zoom:50%;\" /></p>\r\n<p>ç‚¹å‡»<code>CUDA Toolkit 11.3.1</code>å³å¯è·³è½¬åˆ°<a href=\"https://developer.nvidia.com/cuda-11-3-1-download-archive?target_os=Windows&amp;target_arch=x86_64&amp;target_version=10&amp;target_type=exe_local\"><code>CUDA Toolkit 11.3 Update 1 Downloads</code></a></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527112055726.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>ç›´æ¥ç‚¹å‡»<code>Download(2.7GB)</code>ä¸‹è½½å®‰è£…åŒ…ï¼ŒåŒå‡»å®‰è£…</p>\r\n<p>è¿™é‡Œé€‰æ‹©<code>è‡ªå®šä¹‰(c)(é«˜çº§)</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527113136663.png\"  style=\"zoom:50%;\" /></p>\r\n<p>é€‰æ‹©é©±åŠ¨ç¨‹åºç»„ä»¶æ—¶ï¼Œè§†æƒ…å†µè€Œå®šï¼›æˆ‘è¿™é‡Œå–æ¶ˆå‹¾é€‰<code>Driver components</code>å’Œ<code>Other components</code>ï¼Œå› ä¸ºå½“å‰ç‰ˆæœ¬å·²ç»å®‰è£…äº†ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527113247098.png\"  style=\"zoom:50%;\" /></p>\r\n<p>ç‚¹å‡»<code>ä¸‹ä¸€æ­¥</code>ï¼Œç­‰å¾…å®‰è£…å®Œæˆã€‚</p>\r\n<h1 id=\"é…ç½®cudnn\">é…ç½®cuDNN</h1>\r\n<p>è¿›å…¥Nvidiaå®˜ç½‘<a href=\"https://developer.nvidia.com/rdp/cudnn-archive\"><code>cuDNN Archive</code></a>ï¼Œé€‰æ‹©<code>for CUDA 11.X</code>çš„ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527114836975.png\" style=\"zoom:33%;\" /></p>\r\n<p>æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯<code>v8.8.0</code>ç‰ˆæœ¬çš„ï¼Œç‚¹å‡»<code>Local Install for Windows(Zip)</code>ä¸‹è½½</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527114635962.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>è§£å‹åé‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶<span class=\"math inline\">\\(bin|include|lib\\)</span></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527123944344.png\"  style=\"zoom: 43%;\" /></p>\r\n<p>å°†å…¶å¤åˆ¶åˆ°CUDAå®‰è£…ç›®å½•å°±å¥½äº†ï¼Œæˆ‘è¿™é‡ŒæŠŠCUDAå®‰è£…åœ¨Dç›˜äº†ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527124408026.png\"  style=\"zoom:33%;\" /></p>\r\n<h1 id=\"å®‰è£…pytorch\">å®‰è£…pytorch</h1>\r\n<p>æ‰“å¼€<code>Anaconda Prompt</code>ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œæˆ‘è¿™é‡Œå‘½åä¸ºyolov5ï¼›</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n yolov5 python=3.8</span><br></pre></td></tr></table></figure>\r\n<p>æ‰€ç”¨åˆ°çš„å„ç§åŒ…éƒ½æ˜¯åœ¨yolov5è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒä¸‹é…ç½®çš„ï¼Œæ‰€ä»¥éœ€è¦æ¿€æ´»yolov5ç¯å¢ƒ</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda activate yolov5</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527131627319.png\"  style=\"zoom:50%;\" /></p>\r\n<p>è¿›å…¥Pytorchå®˜ç½‘<a href=\"https://pytorch.org/get-started/previous-versions/#installing-previous-versions-of-pytorch\"><code>Installing Previous Versions Of Pytorch</code></a></p>\r\n<p><strong>conda install å®‰è£…</strong></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527130150777.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>æˆ‘è¿™é‡Œæ˜¯å®‰è£…çš„CUDA 11.3ï¼Œè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install pytorch==1.8.1 torchvision==0.9.1 torchaudio==0.8.1 cudatoolkit=11.3 -c pytorch -c conda-forge</span><br></pre></td></tr></table></figure>\r\n<p><code>-c pytorch</code> è¡¨ç¤ºåœ¨pytorchçš„å®˜ç½‘ä¸‹è½½ï¼›<code>-c conda-forge</code> è¡¨ç¤ºåœ¨condaå®˜ç½‘ä¸‹è½½</p>\r\n<p>ä½†æ˜¯pytorchå®˜ç½‘åªæœ‰cpuç‰ˆæœ¬çš„ï¼Œcondaç´¢æ€§æ‰¾ä¸åˆ°äº†ã€‚å¥½åœ¨CUDAæ˜¯å‘ä¸‹å…¼å®¹çš„ï¼Œæœ€åé€‰æ‹©ç”¨pip installçš„æ–¹å¼ä¸‹è½½äº†ã€‚</p>\r\n<p><strong>pip install å®‰è£…</strong></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527130231273.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>æœ€åé€‰æ‹©çš„CUDA 11.1ï¼Œè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼›</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install torch==1.8.1+cu111 torchvision==0.9.1+cu111 torchaudio==0.8.1 -f https://download.pytorch.org/whl/torch_stable.html</span><br></pre></td></tr></table></figure>\r\n<p>åˆ°è¿™é‡Œpytorchç¯å¢ƒå°±é…ç½®å¥½äº†ï¼</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527133453540.png\"  style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"ä¸‹è½½yolo-v5æºä»£ç \">ä¸‹è½½Yolo-v5æºä»£ç </h1>\r\n<p>Yolo-v5æ›´æ–°çš„å¾ˆå¿«ï¼Œä½†æˆ‘å½“æ—¶ç”¨æœåŠ¡å™¨è·‘çš„æ—¶å€™ä¸‹è½½çš„v6.1ç‰ˆæœ¬ï¼Œæ‰€ä»¥ç”¨git bashä¸‹è½½æ–‡ä»¶ã€‚</p>\r\n<p>æˆ‘æ˜¯åœ¨<code>Pycharm Projects</code>é‡Œé¢åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>Yolov5</code>ï¼Œç„¶åå³å‡»é€‰æ‹©<code>Git Bash Here</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527134730082.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>Â ifconfigbash</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> -b v6.1 https://github.com/ultralytics/yolov5.git</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527134152555.png\"  style=\"zoom:50%;\" /></p>\r\n<p>è¿™æ ·å°±æŠŠæºä»£ç ä¸‹è½½å®Œæˆäº†ï¼Œæˆ‘è¿™é‡ŒæŠŠå®ƒé‡å‘½åäº†<code>yolov5-6.1</code>ï¼Œ</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527135851656.png\"  style=\"zoom: 40%;\" /></p>\r\n<p>æ¥ä¸‹æ¥ä»requirements.txtå®‰è£…æ‰€éœ€è¦çš„åŒ…ã€‚æ‰“å¼€<code>Anaconda Prompt</code>ï¼Œcdåˆ°yolov5-6.1æ–‡ä»¶å¤¹</p>\r\n<p>æˆ‘è¿™é‡Œæ˜¯<code>E:\\Pycharm Projects\\Yolov5\\yolov5-6.1</code></p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527140112538.png\" alt=\"image-20230527140112538\" style=\"zoom:50%;\" /></p>\r\n<p>åˆ°è¿™é‡Œå°±å…¨éƒ¨éƒ¨ç½²å®Œæˆå¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŠŠè‡ªå·±çš„æƒé‡æ–‡ä»¶æ›¿æ¢æˆyolov5çš„é¢„è®­ç»ƒæƒé‡æ–‡ä»¶yolov5.ptã€‚</p>\r\n<p>æ‰§è¡Œdetect.pyï¼Œæµ‹è¯•äº†ä¸€ä¸‹ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-1317.jpg\"  style=\"zoom: 45%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-1685.jpg\"  style=\"zoom:45%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527141712871.png\"  style=\"zoom:40%;\" /></p>\r\n<p>è¿˜æ˜¯èƒ½è¾ƒå¥½çš„æŠŠå¯é‡‡æ‘˜çš„è‹¹æœå’Œè¢«é®æŒ¡çš„è‹¹æœè¯†åˆ«å‡ºæ¥ã€‚</p>\r\n",
            "tags": [
                "Python",
                "Yolov5"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%9F%BA%E4%BA%8E%E9%87%87%E6%A0%B7%E7%9A%84%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/",
            "url": "https://liujk6525.github.io/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%9F%BA%E4%BA%8E%E9%87%87%E6%A0%B7%E7%9A%84%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/",
            "title": "åŸºäºé‡‡æ ·çš„è·¯å¾„è§„åˆ’",
            "date_published": "2023-05-13T13:41:15.000Z",
            "content_html": "<h1 id=\"åŸºç¡€çŸ¥è¯†\">åŸºç¡€çŸ¥è¯†</h1>\r\n<p>è™½ç„¶<code>åŸºäºå›¾æœç´¢çš„è·¯å¾„è§„åˆ’ç®—æ³•</code>èƒ½å¤Ÿç»™å‡ºä¸€ä¸ª<strong>å…¨å±€èŒƒå›´å†…çš„æœ€ä¼˜è§£</strong>ï¼Œä½†æ˜¯å½“åœ°å›¾è¿‡å¤§ï¼Œç©ºé—´ç»´åº¦è¿‡é«˜æ—¶ï¼Œå®ƒçš„æœç´¢æ•ˆç‡å°±ä¼šå˜å¾—å¾ˆæ…¢ã€‚ä¸»è¦ç”¨äºä½ç»´ç©ºé—´çš„è·¯å¾„è§„åˆ’é—®é¢˜ã€‚</p>\r\n<span id=\"more\"></span>\r\n<h2 id=\"æ¦‚ç‡è·¯å›¾ç®—æ³•probabilistic-road-map-prm\">æ¦‚ç‡è·¯å›¾ç®—æ³•(Probabilistic Road Map, <a href=\"https://en.wikipedia.org/wiki/Probabilistic_roadmap\"><code>PRM</code></a>)</h2>\r\n<p><code>PRM</code>ç®—æ³•é¦–å…ˆä½¿ç”¨éšæœºé‡‡æ ·çš„æ–¹å¼åœ¨ç¯å¢ƒä¸­å»ºç«‹è·¯å¾„ç½‘ç»œå›¾ï¼Œå°†è¿ç»­çš„ç©ºé—´è½¬æ¢ä¸ºç¦»æ•£çš„ç©ºé—´ï¼Œç„¶ååœ¨è·¯å¾„ç½‘ç»œå›¾ä¸Šè¿›è¡Œè·¯å¾„è§„åˆ’ï¼Œè§£å†³åœ¨é«˜ç»´ç©ºé—´ä¸­æœç´¢æ•ˆç‡ä½çš„é—®é¢˜</p>\r\n<p>ç®—æ³•æµç¨‹</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/prm.png\"  style=\"zoom: 80%;\" /></p>\r\n<p><strong>é‡‡æ ·ç‚¹çš„æ•°é‡</strong>å’Œ<strong>é‡‡æ ·ç‚¹é—´å­˜åœ¨é€šé“çš„æœ€å¤§è·ç¦»</strong>æ˜¯å…³é”®å‚æ•°ï¼Œå…·ä½“çš„</p>\r\n<p>é‡‡æ ·ç‚¹çš„æ•°é‡å¤ªå°‘ï¼Œå¯èƒ½ä¼šå¯¼è‡´è·¯å¾„è§„åˆ’å¤±è´¥ï¼Œå› ä¸ºç”Ÿæˆçš„æ¦‚ç‡è·¯çº¿å°‘äº†ã€‚</p>\r\n<p>éšç€é‡‡æ ·ç‚¹æ•°é‡å¢åŠ ï¼Œç»“æœä¼šè¶Šæ¥è¶Šæ¥è¿‘æœ€çŸ­è·¯å¾„ï¼Œä½†åŒæ—¶æœç´¢æ•ˆç‡ä¼šé™ä½</p>\r\n<h2 id=\"å¿«é€Ÿæ‰©å±•éšæœºæ ‘rapidly-exploring-random-tree-rrtç®—æ³•\">å¿«é€Ÿæ‰©å±•éšæœºæ ‘(Rapidly-exploring Random Tree, <a href=\"https://en.wikipedia.org/wiki/Rapidly-exploring_random_tree\"><code>RRT</code></a>)ç®—æ³•</h2>\r\n<p><code>RRT</code>ç®—æ³•æ˜¯ä¸€ç§å•æŸ¥è¯¢(single-query)ç®—æ³•ï¼Œæœç´¢è¿‡ç¨‹å°±åƒä¸€æ£µæ ‘ä¸æ–­å‘å‘¨å›´æ‰©å±•ç”Ÿé•¿ã€‚å®ƒçš„å¤æ‚åº¦ä¸å—åœ°å›¾çš„ç¦»æ•£ç¨‹åº¦å½±å“ï¼Œåœ¨é«˜ç»´ç©ºé—´ä¸­å…·æœ‰å¾ˆé«˜çš„æœç´¢æ•ˆç‡ã€‚</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/RRT.png\"  style=\"zoom:80%;\" /></p>\r\n<p>ç¼ºç‚¹ï¼šåªç®¡å°½å¿«åœ°æ‰¾åˆ°å¯è¡Œè·¯å¾„ï¼Œæ‰€ä»¥æœ€ç»ˆè·¯å¾„å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œç”šè‡³ä¼šéå¸¸â€œç»•â€ã€‚</p>\r\n<h2 id=\"åŒå‘å¿«é€Ÿæ‰©å±•éšæœºæ ‘rrt-connectç®—æ³•\">åŒå‘å¿«é€Ÿæ‰©å±•éšæœºæ ‘(<a href=\"https://ieeexplore.ieee.org/document/844730\"><code>RRT-Connect</code></a>)ç®—æ³•</h2>\r\n<p>åœ¨<code>RRT</code>çš„åŸºç¡€ä¸Šå¼•å…¥äº†åŒå‘æ‰©å±•ç¯èŠ‚ï¼Œåˆ†åˆ«ä»¥èµ·ç‚¹å’Œç›®æ ‡ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ç”Ÿæˆä¸¤æ£µæ ‘è¿›è¡ŒåŒå‘æ‰©å±•ï¼Œ<strong>åŠ å¿«äº†æœç´¢é€Ÿåº¦</strong>ï¼Œå½“ä¸¤æ£µæ ‘å»ºç«‹è¿æ¥æ—¶è¢«è®¤ä¸ºè·¯å¾„è§„åˆ’æˆåŠŸã€‚</p>\r\n<p>ç¼ºç‚¹ï¼šä½†æ˜¯<code>RRT-Connect</code>å’Œ<code>RRT</code>ä¸€æ ·ï¼Œéƒ½æ˜¯å•æŸ¥è¯¢ç®—æ³•ï¼Œæœ€ç»ˆè·¯å¾„å¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚</p>\r\n<h2 id=\"rrtç®—æ³•\"><a href=\"https://arxiv.org/abs/1105.1186\"><code>RRT*</code></a>ç®—æ³•</h2>\r\n<p><code>RRT*</code>ç®—æ³•æ˜¯ä¸€ç§æ¸è¿‘æœ€ä¼˜ç®—æ³•ã€‚åœ¨<code>RRT</code>ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å°†<span class=\"math inline\">\\(X_{rand}\\)</span>åŠ å…¥æœç´¢æ ‘ T æ—¶<strong>çˆ¶èŠ‚ç‚¹çš„é€‰æ‹©ç­–ç•¥</strong>ã€‚</p>\r\n<p><code>RRT*</code>ç®—æ³•åœ¨é€‰æ‹©çˆ¶èŠ‚ç‚¹æ—¶ä¼šæœ‰ä¸€ä¸ª<strong>é‡è¿(Rewire)</strong>è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ä»¥<span class=\"math inline\">\\(X_{rand}\\)</span>ä¸ºåœ†å¿ƒã€åŠå¾„ä¸º<span class=\"math inline\">\\(r\\)</span>çš„é‚»åŸŸå†…ï¼Œæ‰¾åˆ°ä¸<span class=\"math inline\">\\(X_{new}\\)</span>è¿æ¥åç§»åŠ¨ä»£ä»·(ä»èµ·ç‚¹ç§»åŠ¨åˆ°<span class=\"math inline\">\\(X_{new}\\)</span>çš„è·¯å¾„é•¿åº¦)æœ€å°çš„èŠ‚ç‚¹ï¼Œå¹¶é‡æ–°é€‰æ‹©<span class=\"math inline\">\\(X_{min}\\)</span>ä½œä¸º<span class=\"math inline\">\\(X_{new}\\)</span>çš„çˆ¶èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯<span class=\"math inline\">\\(X_{near}\\)</span>ã€‚</p>\r\n<p>ç®€å•ç†è§£å°±æ˜¯<span class=\"math inline\">\\(Xnear\\)</span>äº§ç”Ÿäº†<span class=\"math inline\">\\(Xnew\\)</span>,ç„¶è€Œ<span class=\"math inline\">\\(Xnew\\)</span>æŠ›å¼ƒäº†<span class=\"math inline\">\\(Xnear\\)</span>ï¼Œé€‰æ‹©äº†ç§»åŠ¨ä»£ä»·æœ€å°çš„<span class=\"math inline\">\\(Xmin\\)</span>ä½œä¸ºçˆ¶èŠ‚ç‚¹ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/v2-1b532a8161587f211b6a7a3c9e239589_720w.webp\"  style=\"zoom: 67%;\" /></p>\r\n<p>ç¼ºç‚¹ï¼š<code>RRT*</code>*æ˜¯å¯¹è‡ªç”±ç©ºé—´è¿›è¡Œå‡åŒ€é‡‡æ ·ï¼Œæœç´¢æ ‘ä¸Šä¼šç”Ÿæˆå¾ˆå¤šå†—ä½™çš„åˆ†æ”¯ï¼Œæ‰€ä»¥<code>RRT*</code>çš„æ”¶æ•›é€Ÿåº¦å¾ˆæ…¢ã€‚</p>\r\n<h2 id=\"informed-rrtç®—æ³•\"><a href=\"https://arxiv.org/abs/1404.2334\"><code>Informed-RRT*</code></a>ç®—æ³•</h2>\r\n<p>å¯¹<code>RRT*</code>çš„æ”¹è¿›ç­–ç•¥ï¼šé‡‡ç”¨æ¤­åœ†é‡‡æ ·æ¥ä»£æ›¿å…¨å±€å‡åŒ€é‡‡æ ·</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230514175249529.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>ä»¥èµ·ç‚¹ <span class=\"math inline\">\\(X_{start}\\)</span>å’Œç»ˆç‚¹<span class=\"math inline\">\\(X_{goal}\\)</span>ä½œä¸ºæ¤­åœ†çš„ç„¦ç‚¹ï¼Œä»¤<span class=\"math inline\">\\(a\\)</span>ç­‰äºåˆå§‹è·¯å¾„é•¿åº¦<span class=\"math inline\">\\(c_{best}\\)</span>çš„ä¸€åŠï¼Œå³<span class=\"math inline\">\\(a=\\frac{c_{best}}{2}\\)</span>ï¼Œåˆ™$ c=<span class=\"math inline\">\\(ï¼Œ\\)</span>b=$ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°æ¤­åœ†æ–¹ç¨‹çš„æ‰€æœ‰å‚æ•°ã€‚</p>\r\n<p>åœ¨ä¹‹åçš„è¿­ä»£ä¸­ï¼Œå¦‚æœæ²¡æ‰¾åˆ°æ›´çŸ­çš„è·¯å¾„ï¼Œå°±ç”¨<span class=\"math inline\">\\(c_{min}\\)</span>ä½œä¸ºæ–°çš„<span class=\"math inline\">\\(c_{best}\\)</span>ï¼Œç„¶ååœ¨æ–°çš„æ¤­åœ†åŒºåŸŸè¿›è¡Œé‡‡æ ·ã€‚</p>\r\n<h1 id=\"ä»£ç å®ç°\">ä»£ç å®ç°</h1>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230514234320378.png\"  style=\"zoom:80%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230514234432119.png\"  style=\"zoom:80%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230514234602917.png\"  style=\"zoom:80%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230514234911888.png\"  style=\"zoom:80%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://zhuanlan.zhihu.com/p/349074802\"><code>è·¯å¾„è§„åˆ’ | éšæœºé‡‡æ ·ç®—æ³•ï¼šPRMã€RRTã€RRT-Connectã€RRT*</code></a></p>\r\n<p><a href=\"https://zhuanlan.zhihu.com/p/372315811\"><code>è·¯å¾„è§„åˆ’ | éšæœºé‡‡æ ·ç®—æ³•ï¼šInformed-RRT*</code></a></p>\r\n<p><a href=\"https://www.bilibili.com/video/BV1yT4y1T7Eb?p=5\"><code>æœºå™¨äººè·¯å¾„è§„åˆ’ã€è½¨è¿¹ä¼˜åŒ–ç³»åˆ—è¯¾ç¨‹</code></a></p>\r\n<p>[1] Lavalle S M . Rapidly-Exploring Random Trees: A New Tool for Path Planning[J]. Research Report, 1999.</p>\r\n<p>[2] Jr J , Lavalle S M . RRT-Connect: An Efficient Approach to Single-Query Path Planning[C]// Proceedings of the 2000 IEEE International Conference on Robotics and Automation, ICRA 2000, April 24-28, 2000, San Francisco, CA, USA. IEEE, 2000.</p>\r\n<p>[3] Karaman S , Frazzoli E . Sampling-based Algorithms for Optimal Motion Planning[J]. The International Journal of Robotics Research, 2011, 30(7):846-894.</p>\r\n<p>[4] Gammell J D , Srinivasa S S , Barfoot T D . Informed RRT*: Optimal Sampling-based Path Planning Focused via Direct Sampling of an Admissible Ellipsoidal Heuristic[J]. IEEE, 2014.</p>\r\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://liujk6525.github.io/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%9F%BA%E4%BA%8E%E6%90%9C%E7%B4%A2%E7%9A%84%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/",
            "url": "https://liujk6525.github.io/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%9F%BA%E4%BA%8E%E6%90%9C%E7%B4%A2%E7%9A%84%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/",
            "title": "åŸºäºæœç´¢çš„è·¯å¾„è§„åˆ’",
            "date_published": "2023-05-12T03:36:41.000Z",
            "content_html": "<h1 id=\"åŸºç¡€çŸ¥è¯†\">åŸºç¡€çŸ¥è¯†</h1>\r\n<p><strong>å›¾æœç´¢æ³•</strong>æ˜¯é€šè¿‡åˆ©ç”¨å·²æœ‰çš„ç¯å¢ƒåœ°å›¾å’Œéšœç¢ç‰©ç­‰æ•°æ®ä¿¡æ¯ï¼Œå»ºç«‹ç”±èµ·ç‚¹è‡³ç›®æ ‡ç‚¹çš„å¯è¡Œè·¯çº¿ã€‚</p>\r\n<p><strong>é…ç½®ç©ºé—´(Configuration Space)</strong> åœ¨å®é™…ç¯å¢ƒï¼Œè¦å°†å·¥ä½œç©ºé—´è½¬æ¢åˆ°é…ç½®ç©ºé—´ä¸­ï¼Œå³å°†æœºå™¨äººè½¬åŒ–ä¸ºä¸€ä¸ª<strong>è´¨ç‚¹</strong>ï¼ŒåŒæ—¶å°†éšœç¢ç‰©æŒ‰ç…§æœºå™¨äººçš„ä½“ç§¯è¿›è¡Œè†¨èƒ€</p>\r\n<span id=\"more\"></span>\r\n<h2 id=\"åŸºæœ¬æµç¨‹\">åŸºæœ¬æµç¨‹</h2>\r\n<ul>\r\n<li>åœ¨å®¹å™¨<code>open list</code>ä¸­å­˜æ”¾å°†è¦è®¿é—®çš„èŠ‚ç‚¹</li>\r\n<li>å°†èµ·ç‚¹åŠ å…¥å®¹å™¨</li>\r\n<li>While Trueï¼š</li>\r\n<li>å¼¹å‡ºï¼šä»å®¹å™¨ä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹</li>\r\n<li>æ‰©å±•ï¼šå°†è¯¥èŠ‚ç‚¹å‘¨å›´çš„å…¶ä»–èŠ‚ç‚¹æ”¾å…¥<code>open list</code></li>\r\n</ul>\r\n<h2 id=\"æ·±åº¦ä¼˜å…ˆæœç´¢depth-first-search-dfs-ç®—æ³•\">æ·±åº¦ä¼˜å…ˆæœç´¢(Depth First Search, <a href=\"https://zh.wikipedia.org/wiki/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2\"><code>DFS</code></a> )ç®—æ³•</h2>\r\n<ul>\r\n<li>ä¼˜å…ˆæ‰©å±•æœç´¢æ·±åº¦è¾ƒå¤§çš„èŠ‚ç‚¹ï¼Œä»èµ·ç‚¹å¼€å§‹ï¼ŒæŒ‰ç…§æŸä¸ªé¡ºåºä¸€æ¡è·¯èµ°ä¸‹å»ï¼Œç›´è‡³ä¸èƒ½å†ç»§ç»­ä¸ºæ­¢ï¼Œç„¶åå›åˆ°ä¸Šä¸€èŠ‚ç‚¹ï¼Œå†æ¢å¦ä¸€æ¡è·¯èµ°ä¸‹å»ï¼›</li>\r\n<li>æ·±åº¦ä¼˜å…ˆæœç´¢çš„è¿‡ç¨‹æ˜¯ä¸€æ¡è·¯èµ°åˆ°åº•åï¼Œæœ€åè®¿é—®çš„èŠ‚ç‚¹æœ€å…ˆæ‹¿æ¥å¤„ç†ï¼Œæ•´ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨<code>æ ˆ(stack)</code>æ¥è¡¨ç¤ºâ€”â€”<strong>åè¿›å…ˆå‡º</strong>ã€‚</li>\r\n<li>æ·±åº¦ä¼˜å…ˆç®—æ³•ä¼˜å…ˆæ‰©å±•æœç´¢æ·±åº¦è¾ƒå¤§çš„èŠ‚ç‚¹ï¼Œå› æ­¤èƒ½å¤Ÿæ›´è¿…é€Ÿçš„è·å¾—ä¸‹ä¸€ä¸ªå¯è¡Œè·¯å¾„ï¼Œä¸è¿‡æ·±åº¦ä¼˜å…ˆç®—æ³•è·å–çš„ç¬¬ä¸€ä¸ªè·¯å¾„é€šå¸¸æ˜¯æ¯”è¾ƒé•¿çš„è·¯å¾„ã€‚</li>\r\n</ul>\r\n<p>åœ¨<strong>æ— æƒå›¾</strong>ä¸­æ‰¾åˆ°ä»èŠ‚ç‚¹<code>a</code>åˆ°èŠ‚ç‚¹<code>j</code>çš„è·¯å¾„ä¸ºä¾‹</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/dfs.png\"  style=\"zoom:80%;\" /></p>\r\n<p>æŒ‰ç…§<code>DFS</code>çš„åŸºæœ¬æµç¨‹æœç´¢<code>a</code>åˆ°<code>j</code>çš„è·¯å¾„ï¼š</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/dfs-1683872034517-4.png\"  style=\"zoom:80%;\" /></p>\r\n<p>ä»ç›®æ ‡ç‚¹å¼€å§‹å›æº¯ï¼š<code>a-&gt;b-&gt;f-&gt;j</code></p>\r\n<h2 id=\"å¹¿åº¦ä¼˜å…ˆæœç´¢breadth-first-search-bfsç®—æ³•\">å¹¿åº¦ä¼˜å…ˆæœç´¢(Breadth First Search, <a href=\"https://zh.wikipedia.org/zh-hans/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2\"><code>BFS</code></a>)ç®—æ³•</h2>\r\n<ul>\r\n<li><p>æ¯ä¸€æ­¥éƒ½æ‰©å±•åŒä¸€å±‚çš„æ‰€æœ‰å¯èƒ½èŠ‚ç‚¹ï¼Œä¸€å±‚ä¸€å±‚æ‰©å±•ä¸‹å»ï¼Œç›´åˆ°æŸä¸€å±‚æœç´¢åˆ°ç»ˆç‚¹ä¸ºæ­¢ã€‚</p></li>\r\n<li><p>å¹¿åº¦ä¼˜å…ˆæœç´¢çš„è¿‡ç¨‹æ˜¯ä¸€å±‚ä¸­å…ˆè®¿é—®çš„èŠ‚ç‚¹æ‹¿æ¥å¤„ç†ï¼Œå¯ä»¥ç”¨<code>é˜Ÿåˆ—(queue)</code>æ¥è¡¨ç¤ºâ€”â€”<strong>å…ˆè¿›å…ˆå‡º</strong>ã€‚</p></li>\r\n<li><p>å¹¿åº¦ä¼˜å…ˆç®—æ³•ä¼˜å…ˆæ‰©å±•æ·±å…¥è¾ƒå°çš„èŠ‚ç‚¹ï¼Œå‘ˆ<strong>æ³¢çŠ¶æ¨è¿›</strong>çš„å½¢å¼æœç´¢ã€‚å› æ­¤å¹¿åº¦ä¼˜å…ˆç®—æ³•æ£€ç´¢åˆ°çš„ç¬¬ä¸€ä¸ªè·¯å¾„é€šå¸¸æ˜¯æœ€çŸ­è·¯å¾„ã€‚</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/bfs.png\"   style=\"zoom:80%;\" /></p></li>\r\n</ul>\r\n<h2 id=\"è´ªå©ªæœ€ä½³ä¼˜å…ˆæœç´¢greedy-best-first-searchgbfs-ç®—æ³•\">è´ªå©ªæœ€ä½³ä¼˜å…ˆæœç´¢(Greedy Best First Search,<a href=\"https://www.codecademy.com/resources/docs/ai/search-algorithms/greedy-best-first-search\"><code>GBFS</code></a> )ç®—æ³•</h2>\r\n<p>ä½¿ç”¨çš„æ˜¯<strong>ä¼˜å…ˆé˜Ÿåˆ—(Priority Queue)</strong>ï¼Œæ™®é€šé˜Ÿåˆ—æ˜¯ä¸€ç§<strong>å…ˆè¿›å…ˆå‡º</strong>çš„æ•°æ®ç»“æ„ï¼Œè€Œåœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­å…ƒç´ è¢«èµ‹äºˆäº†ä¼˜å…ˆçº§ï¼Œæœ€é«˜ä¼˜å…ˆçº§å…ƒç´ ä¼˜å…ˆåˆ é™¤ï¼Œä¹Ÿå°±æ˜¯<code>first in</code>, <code>largest out</code></p>\r\n<p>åœ¨å›¾æœç´¢ç®—æ³•ä¸­ï¼Œä¼˜å…ˆçº§åˆ¤æ–­çš„æ ‡å‡†æ˜¯ä»£ä»·å‡½æ•° <span class=\"math inline\">\\(f(n)\\)</span> ï¼Œ <span class=\"math inline\">\\(f(n)\\)</span> è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</p>\r\n<p><span class=\"math display\">\\[\r\nf(n)=h(n)\r\n\\]</span></p>\r\n<p><span class=\"math inline\">\\(h(n)\\)</span>æ˜¯å¯å‘å¼å‡½æ•°ï¼Œä¸ºèŠ‚ç‚¹<span class=\"math inline\">\\(n\\)</span>åˆ°ç›®æ ‡èŠ‚ç‚¹ä¹‹é—´æ‰€å½¢æˆè·¯å¾„çš„æœ€å°ä»£ä»·å€¼ã€‚ä¸€èˆ¬ä¸º<a href=\"https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB\"><code>æ¬§æ°è·ç¦»</code></a>æˆ–è€…<a href=\"https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%93%88%E9%A0%93%E8%B7%9D%E9%9B%A2\"><code>æ›¼å“ˆé¡¿è·ç¦»</code></a></p>\r\n<p>é‡åˆ°éšœç¢ç‰©æ—¶ï¼Œå®ƒå¾ˆå®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜çš„é™·é˜±ã€‚</p>\r\n<h1 id=\"dijkstraç®—æ³•\"><a href=\"https://zh.wikipedia.org/wiki/%E6%88%B4%E5%85%8B%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95\"><code>Dijkstra</code></a>ç®—æ³•</h1>\r\n<p>Dijkstraç®—æ³•æ˜¯ä»ä¸€ä¸ªé¡¶ç‚¹åˆ°å…¶ä½™å„é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œå…¶æµç¨‹ä»ç„¶ä¸ä¸Šè¿°ç®—æ³•åŸºæœ¬ä¸€è‡´ï¼Œå®ƒä¹Ÿæ˜¯ç”¨ä¼˜å…ˆé˜Ÿåˆ—ä½œä¸º<code>open list</code>çš„æ•°æ®ç»“æ„ï¼Œå®ƒå’Œ<code>GBFS</code>çš„åŒºåˆ«åœ¨äºä»£ä»·å‡½æ•° <span class=\"math inline\">\\(f(n)\\)</span>çš„å®šä¹‰:</p>\r\n<p><span class=\"math display\">\\[\r\nf(n)=g(n)\r\n\\]</span> <span class=\"math inline\">\\(g(n)\\)</span>è¡¨ç¤ºä»èµ·å§‹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹<span class=\"math inline\">\\(n\\)</span>çš„ç§»åŠ¨ä»£ä»·å‡½æ•°ã€‚</p>\r\n<p>è®¡ç®—èµ·ç‚¹<code>v1</code>åˆ°ç»ˆç‚¹<code>v6</code>çš„æœ€çŸ­è·¯å¾„ï¼Œç®­å¤´ä¸Šçš„æ•°å€¼è¡¨ç¤º<strong>ä¸¤ä¸ªèŠ‚ç‚¹é—´çš„è·ç¦»</strong></p>\r\n<ol type=\"1\">\r\n<li><p>é¦–å…ˆæ‰©å±•ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®¡ç®—å…¶ä½™é‚»è¿‘èŠ‚ç‚¹ä¸ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„è·ç¦»ï¼Œä»æœªæ‰©å±•çš„èŠ‚ç‚¹ä¸­é€‰æ‹©ä»£ä»·å‡½æ•°æœ€å°çš„èŠ‚ç‚¹è¿›è¡Œæ‰©å±•ï¼Œå¹¶æ›´æ–°å…¶ä½™èŠ‚ç‚¹çš„ä»£ä»·å‡½æ•°</p></li>\r\n<li><p>é‡å¤è¿›è¡Œä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²æ‰©å±•ã€‚</p></li>\r\n<li><p>æœ€åæ ‡å‡ºèµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„</p>\r\n<p>æ‰¾åˆ°ä¸€æ¡ä»<code>1</code>åˆ°<code>6</code>çš„æœ€çŸ­è·¯å¾„</p></li>\r\n</ol>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512205640371.png\"  style=\"zoom:80%;\" /></p>\r\n<p><code>open list</code>: 4(1) 2(2) # å­˜å‚¨å·²ç»è¢«æœç´¢è¿‡ä½†æ²¡æœ‰è¢«è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ’åº</p>\r\n<p><code>closed list</code>:1(0) # å­˜å‚¨å·²ç»è¢«è®¿é—®è¿‡çš„èŠ‚ç‚¹</p>\r\n<p>ä»<code>open list</code>ä¸­çš„èŠ‚ç‚¹ä¸­é€‰æ‹©è·ç¦»æœ€å°çš„èŠ‚ç‚¹ä½œä¸ºæ‰©å±•èŠ‚ç‚¹ï¼Œæ˜¾ç„¶æ˜¯èŠ‚ç‚¹4ã€‚</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512210430685.png\"  style=\"zoom:80%;\" /></p>\r\n<p><code>open list</code>: 2(2) 3(3) 7(5) 6(9) # éå†é‚»æ¥èŠ‚ç‚¹ï¼Œæ›´æ–°è·ç¦»</p>\r\n<p><code>closed list</code>: 1(0) 4(1)</p>\r\n<p>é‡å¤ä¸Šè¿°æ“ä½œã€‚é€‰æ‹©æ–°çš„æ‰©å±•èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹2</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512211350445.png\" style=\"zoom:80%;\" /></p>\r\n<p><code>open list</code>: 3(3) 7(5) <strong>6(9)</strong> 5(13)</p>\r\n<p><code>closed list</code>: 1(0) 4(1) 2(2)</p>\r\n<p>é€‰æ‹©æ–°çš„æ‰©å±•èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹3</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512212316556.png\" style=\"zoom:80%;\" /></p>\r\n<p><code>open list</code>: 7(5) <strong>6(8)</strong> 5(13) # æ³¨æ„è¿™é‡Œè®¿é—®èŠ‚ç‚¹3ï¼Œå¯¹å®ƒçš„é¢†æ¥èŠ‚ç‚¹6çš„è·ç¦»è¿›è¡Œäº†æ›´æ–°</p>\r\n<p><code>closed list</code>: 1(0) 4(1) 2(2) 3(3)</p>\r\n<p>é€‰æ‹©æ–°çš„æ‰©å±•èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹7</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512213110030.png\"  style=\"zoom:80%;\" /></p>\r\n<p><code>open list</code>: <strong>6(6)</strong> 5(13) # æ³¨æ„è¿™é‡Œè®¿é—®èŠ‚ç‚¹7ï¼Œå¯¹å®ƒçš„é¢†æ¥èŠ‚ç‚¹6çš„è·ç¦»è¿›è¡Œäº†æ›´æ–°</p>\r\n<p><code>closed list</code>: 1(0) 4(1) 2(2) 3(3) 7(5)</p>\r\n<p>â€‹ <img src=\"/imgs/$%7Bfiilename%7D/image-20230512214147752.png\"  style=\"zoom:80%;\" /></p>\r\n<p><code>closed list</code>: 1(0) 4(1) 2(2) 3(3) 7(5) 6(6)</p>\r\n<h1 id=\"aæœç´¢a-searchç®—æ³•\"><code>A*</code>æœç´¢(<a href=\"https://zh.wikipedia.org/wiki/A*%E6%90%9C%E5%B0%8B%E6%BC%94%E7%AE%97%E6%B3%95\"><code>A* search</code></a>)ç®—æ³•</h1>\r\n<p><code>GBFS</code>ç”¨èŠ‚ç‚¹åˆ°ç›®æ ‡ç‚¹çš„è·ç¦»ä½œä¸ºä»£ä»·å‡½æ•°ï¼Œå°†æœç´¢æ–¹å‘å¼•å‘ç›®æ ‡ç‚¹ï¼Œæœç´¢æ•ˆç‡é«˜ã€‚</p>\r\n<p><code>Dijkstra</code>ç®—æ³•é‡‡ç”¨èµ·ç‚¹åˆ°å½“å‰æ‰©å±•èŠ‚ç‚¹çš„ç§»åŠ¨ä»£ä»·ä½œä¸ºä»£ä»·å‡½æ•°ï¼Œèƒ½å¤Ÿç¡®ä¿è·¯å¾„æœ€ä¼˜ã€‚</p>\r\n<p><code>A*</code>æœç´¢ç®—æ³•åœ¨<code>Dijkstra</code>ç®—æ³•çš„åŸºç¡€ä¸Šå¢åŠ å¯å‘å¼å‡½æ•°<span class=\"math inline\">\\(h(n)\\)</span>ï¼Œè§„å®šå…¶ä»£ä»·å‡½æ•°ä¸º <span class=\"math display\">\\[\r\nf(n)=g(n)+h(n)\r\n\\]</span></p>\r\n<h1 id=\"ä»£ç å®ç°\">ä»£ç å®ç°</h1>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/Astart.png\" alt=\"Astart\" style=\"zoom:80%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/dijkstra.png\" alt=\"dijkstra\" style=\"zoom:80%;\" /></p>\r\n<h1 id=\"å‚è€ƒ\">å‚è€ƒ</h1>\r\n<p><a href=\"https://zhuanlan.zhihu.com/p/346666812\"><code>è·¯å¾„è§„åˆ’ | å›¾æœç´¢ç®—æ³•ï¼šDFSã€BFSã€GBFSã€Dijkstraã€A*</code></a></p>\r\n<p><a href=\"https://www.bilibili.com/video/BV1yT4y1T7Eb?p=2\">æœºå™¨äººè·¯å¾„è§„åˆ’ã€è½¨è¿¹ä¼˜åŒ–ç³»åˆ—è¯¾ç¨‹</a></p>\r\n",
            "tags": [
                "Python"
            ]
        }
    ]
}