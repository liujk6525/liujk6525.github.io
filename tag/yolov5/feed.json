{
    "version": "https://jsonfeed.org/version/1",
    "title": "你不是单打独斗 • All posts by \"yolov5\" tag",
    "description": "",
    "home_page_url": "https://liujk6525.github.io",
    "items": [
        {
            "id": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9AYolo-v5/",
            "url": "https://liujk6525.github.io/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/%E8%B7%91%E9%80%9AYolo-v5/",
            "title": "wii11系统跑通Yolo-v5",
            "date_published": "2023-05-27T02:06:35.000Z",
            "content_html": "<p>之前跑Yolo-v5是在服务器跑的，现在把权重文件跑完了，正好最近换了新电脑，在本地部署跑跑看，记录如下：</p>\r\n<p>复现<img src=\"/imgs/$%7Bfiilename%7D/b3809ce4a80e96cf09f6d500abed0fbd_129107_720_720.jpg\"  style=\"zoom:5%;\" />大佬们的项目之前一定要看这个项目所需的配置环境，掉大坑！！！</p>\r\n<p>目标：Yolo-v5 v6.1版本</p>\r\n<p>环境：cuda 11.3 | pytorch 1.8.1</p>\r\n<span id=\"more\"></span>\r\n<h1 id=\"安装anaconda3\">安装Anaconda3</h1>\r\n<p><a href=\"https://www.anaconda.com/\"><code>anaconda官网</code></a></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527104222716.png\" alt=\"image-20230527104222716\" style=\"zoom:33%;\" /></p>\r\n<p>直接点击<code>Download</code>下载安装包，双击安装</p>\r\n<p>我把<code>Anaconda</code>安装在D盘了</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527105216332.png\"  style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"安装cuda\">安装CUDA</h1>\r\n<p>安装之前先看下自己电脑配置条件，在终端输入</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvidia-smi</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527105741395.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>可以看到<code>Driver Version: 512.98</code></p>\r\n<p>在对照<a href=\"https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html\"><code>nvidia官网显卡驱动</code></a>给出的版本要求选择CUDA版本，这里我选择的是<code>CUDA 11.3</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527110416589.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>然后来到<a href=\"https://developer.nvidia.com/cuda-toolkit-archive\"><code>CUDA Toolkit Archive</code></a>，</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527111819649.png\"  style=\"zoom:50%;\" /></p>\r\n<p>点击<code>CUDA Toolkit 11.3.1</code>即可跳转到<a href=\"https://developer.nvidia.com/cuda-11-3-1-download-archive?target_os=Windows&amp;target_arch=x86_64&amp;target_version=10&amp;target_type=exe_local\"><code>CUDA Toolkit 11.3 Update 1 Downloads</code></a></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527112055726.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>直接点击<code>Download(2.7GB)</code>下载安装包，双击安装</p>\r\n<p>这里选择<code>自定义(c)(高级)</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527113136663.png\"  style=\"zoom:50%;\" /></p>\r\n<p>选择驱动程序组件时，视情况而定；我这里取消勾选<code>Driver components</code>和<code>Other components</code>，因为当前版本已经安装了。</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527113247098.png\"  style=\"zoom:50%;\" /></p>\r\n<p>点击<code>下一步</code>，等待安装完成。</p>\r\n<h1 id=\"配置cudnn\">配置cuDNN</h1>\r\n<p>进入Nvidia官网<a href=\"https://developer.nvidia.com/rdp/cudnn-archive\"><code>cuDNN Archive</code></a>，选择<code>for CUDA 11.X</code>的。</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527114836975.png\" style=\"zoom:33%;\" /></p>\r\n<p>我这里选择的是<code>v8.8.0</code>版本的，点击<code>Local Install for Windows(Zip)</code>下载</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527114635962.png\"  style=\"zoom: 33%;\" /></p>\r\n<p>解压后里面有三个文件<span class=\"math inline\">\\(bin|include|lib\\)</span></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527123944344.png\"  style=\"zoom: 43%;\" /></p>\r\n<p>将其复制到CUDA安装目录就好了，我这里把CUDA安装在D盘了。</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527124408026.png\"  style=\"zoom:33%;\" /></p>\r\n<h1 id=\"安装pytorch\">安装pytorch</h1>\r\n<p>打开<code>Anaconda Prompt</code>，输入如下命令，创建一个虚拟环境，我这里命名为yolov5；</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n yolov5 python=3.8</span><br></pre></td></tr></table></figure>\r\n<p>所用到的各种包都是在yolov5这个虚拟环境下配置的，所以需要激活yolov5环境</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda activate yolov5</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527131627319.png\"  style=\"zoom:50%;\" /></p>\r\n<p>进入Pytorch官网<a href=\"https://pytorch.org/get-started/previous-versions/#installing-previous-versions-of-pytorch\"><code>Installing Previous Versions Of Pytorch</code></a></p>\r\n<p><strong>conda install 安装</strong></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527130150777.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>我这里是安装的CUDA 11.3，输入以下指令</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda install pytorch==1.8.1 torchvision==0.9.1 torchaudio==0.8.1 cudatoolkit=11.3 -c pytorch -c conda-forge</span><br></pre></td></tr></table></figure>\r\n<p><code>-c pytorch</code> 表示在pytorch的官网下载；<code>-c conda-forge</code> 表示在conda官网下载</p>\r\n<p>但是pytorch官网只有cpu版本的，conda索性找不到了。好在CUDA是向下兼容的，最后选择用pip install的方式下载了。</p>\r\n<p><strong>pip install 安装</strong></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527130231273.png\"  style=\"zoom: 50%;\" /></p>\r\n<p>最后选择的CUDA 11.1，输入以下指令；</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install torch==1.8.1+cu111 torchvision==0.9.1+cu111 torchaudio==0.8.1 -f https://download.pytorch.org/whl/torch_stable.html</span><br></pre></td></tr></table></figure>\r\n<p>到这里pytorch环境就配置好了！</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527133453540.png\"  style=\"zoom: 67%;\" /></p>\r\n<h1 id=\"下载yolo-v5源代码\">下载Yolo-v5源代码</h1>\r\n<p>Yolo-v5更新的很快，但我当时用服务器跑的时候下载的v6.1版本，所以用git bash下载文件。</p>\r\n<p>我是在<code>Pycharm Projects</code>里面创建一个文件夹<code>Yolov5</code>，然后右击选择<code>Git Bash Here</code></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527134730082.png\"  style=\"zoom: 50%;\" /></p>\r\n<p> ifconfigbash</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> -b v6.1 https://github.com/ultralytics/yolov5.git</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527134152555.png\"  style=\"zoom:50%;\" /></p>\r\n<p>这样就把源代码下载完成了，我这里把它重命名了<code>yolov5-6.1</code>，</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527135851656.png\"  style=\"zoom: 40%;\" /></p>\r\n<p>接下来从requirements.txt安装所需要的包。打开<code>Anaconda Prompt</code>，cd到yolov5-6.1文件夹</p>\r\n<p>我这里是<code>E:\\Pycharm Projects\\Yolov5\\yolov5-6.1</code></p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527140112538.png\" alt=\"image-20230527140112538\" style=\"zoom:50%;\" /></p>\r\n<p>到这里就全部部署完成好了，接下来就是把自己的权重文件替换成yolov5的预训练权重文件yolov5.pt。</p>\r\n<p>执行detect.py，测试了一下。</p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-1317.jpg\"  style=\"zoom: 45%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-1685.jpg\"  style=\"zoom:45%;\" /></p>\r\n<p><img src=\"/imgs/$%7Bfiilename%7D/image-20230527141712871.png\"  style=\"zoom:40%;\" /></p>\r\n<p>还是能较好的把可采摘的苹果和被遮挡的苹果识别出来。</p>\r\n",
            "tags": [
                "Python",
                "Yolov5"
            ]
        }
    ]
}